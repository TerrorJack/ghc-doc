<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE Trustworthy #-}</span><span>
</span><a name="line-2"></a><span class="hs-pragma">{-# LANGUAGE NoImplicitPrelude #-}</span><span>
</span><a name="line-3"></a><span class="hs-pragma">{-# LANGUAGE RankNTypes #-}</span><span>
</span><a name="line-4"></a><span class="hs-pragma">{-# LANGUAGE MagicHash #-}</span><span>
</span><a name="line-5"></a><span class="hs-pragma">{-# LANGUAGE DeriveFunctor #-}</span><span>
</span><a name="line-6"></a><span>
</span><a name="line-7"></a><span class="hs-comment">-----------------------------------------------------------------------------</span><span>
</span><a name="line-8"></a><span class="hs-comment">-- |</span><span>
</span><a name="line-9"></a><span class="hs-comment">-- Module      :  Text.ParserCombinators.ReadP</span><span>
</span><a name="line-10"></a><span class="hs-comment">-- Copyright   :  (c) The University of Glasgow 2002</span><span>
</span><a name="line-11"></a><span class="hs-comment">-- License     :  BSD-style (see the file libraries/base/LICENSE)</span><span>
</span><a name="line-12"></a><span class="hs-comment">--</span><span>
</span><a name="line-13"></a><span class="hs-comment">-- Maintainer  :  libraries@haskell.org</span><span>
</span><a name="line-14"></a><span class="hs-comment">-- Stability   :  provisional</span><span>
</span><a name="line-15"></a><span class="hs-comment">-- Portability :  non-portable (local universal quantification)</span><span>
</span><a name="line-16"></a><span class="hs-comment">--</span><span>
</span><a name="line-17"></a><span class="hs-comment">-- This is a library of parser combinators, originally written by Koen Claessen.</span><span>
</span><a name="line-18"></a><span class="hs-comment">-- It parses all alternatives in parallel, so it never keeps hold of</span><span>
</span><a name="line-19"></a><span class="hs-comment">-- the beginning of the input string, a common source of space leaks with</span><span>
</span><a name="line-20"></a><span class="hs-comment">-- other parsers.  The '(+++)' choice combinator is genuinely commutative;</span><span>
</span><a name="line-21"></a><span class="hs-comment">-- it makes no difference which branch is \&quot;shorter\&quot;.</span><span>
</span><a name="line-22"></a><span>
</span><a name="line-23"></a><span class="hs-comment">-----------------------------------------------------------------------------</span><span>
</span><a name="line-24"></a><span>
</span><a name="line-25"></a><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Text</span><span class="hs-operator">.</span><span class="hs-identifier">ParserCombinators</span><span class="hs-operator">.</span><span class="hs-identifier">ReadP</span><span>
</span><a name="line-26"></a><span>  </span><span class="hs-special">(</span><span>
</span><a name="line-27"></a><span>  </span><span class="hs-comment">-- * The 'ReadP' type</span><span>
</span><a name="line-28"></a><span>  </span><a href="Text.ParserCombinators.ReadP.html#ReadP"><span class="hs-identifier hs-type">ReadP</span></a><span class="hs-special">,</span><span>
</span><a name="line-29"></a><span>
</span><a name="line-30"></a><span>  </span><span class="hs-comment">-- * Primitive operations</span><span>
</span><a name="line-31"></a><span>  </span><a href="Text.ParserCombinators.ReadP.html#get"><span class="hs-identifier hs-var">get</span></a><span class="hs-special">,</span><span>
</span><a name="line-32"></a><span>  </span><a href="Text.ParserCombinators.ReadP.html#look"><span class="hs-identifier hs-var">look</span></a><span class="hs-special">,</span><span>
</span><a name="line-33"></a><span>  </span><span class="hs-special">(</span><a href="Text.ParserCombinators.ReadP.html#%2B%2B%2B"><span class="hs-operator hs-var">+++</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><a name="line-34"></a><span>  </span><span class="hs-special">(</span><a href="Text.ParserCombinators.ReadP.html#%3C%2B%2B"><span class="hs-operator hs-var">&lt;++</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><a name="line-35"></a><span>  </span><a href="Text.ParserCombinators.ReadP.html#gather"><span class="hs-identifier hs-var">gather</span></a><span class="hs-special">,</span><span>
</span><a name="line-36"></a><span>
</span><a name="line-37"></a><span>  </span><span class="hs-comment">-- * Other operations</span><span>
</span><a name="line-38"></a><span>  </span><a href="Text.ParserCombinators.ReadP.html#pfail"><span class="hs-identifier hs-var">pfail</span></a><span class="hs-special">,</span><span>
</span><a name="line-39"></a><span>  </span><a href="Text.ParserCombinators.ReadP.html#eof"><span class="hs-identifier hs-var">eof</span></a><span class="hs-special">,</span><span>
</span><a name="line-40"></a><span>  </span><a href="Text.ParserCombinators.ReadP.html#satisfy"><span class="hs-identifier hs-var">satisfy</span></a><span class="hs-special">,</span><span>
</span><a name="line-41"></a><span>  </span><a href="Text.ParserCombinators.ReadP.html#char"><span class="hs-identifier hs-var">char</span></a><span class="hs-special">,</span><span>
</span><a name="line-42"></a><span>  </span><a href="Text.ParserCombinators.ReadP.html#string"><span class="hs-identifier hs-var">string</span></a><span class="hs-special">,</span><span>
</span><a name="line-43"></a><span>  </span><a href="Text.ParserCombinators.ReadP.html#munch"><span class="hs-identifier hs-var">munch</span></a><span class="hs-special">,</span><span>
</span><a name="line-44"></a><span>  </span><a href="Text.ParserCombinators.ReadP.html#munch1"><span class="hs-identifier hs-var">munch1</span></a><span class="hs-special">,</span><span>
</span><a name="line-45"></a><span>  </span><a href="Text.ParserCombinators.ReadP.html#skipSpaces"><span class="hs-identifier hs-var">skipSpaces</span></a><span class="hs-special">,</span><span>
</span><a name="line-46"></a><span>  </span><a href="Text.ParserCombinators.ReadP.html#choice"><span class="hs-identifier hs-var">choice</span></a><span class="hs-special">,</span><span>
</span><a name="line-47"></a><span>  </span><a href="Text.ParserCombinators.ReadP.html#count"><span class="hs-identifier hs-var">count</span></a><span class="hs-special">,</span><span>
</span><a name="line-48"></a><span>  </span><a href="Text.ParserCombinators.ReadP.html#between"><span class="hs-identifier hs-var">between</span></a><span class="hs-special">,</span><span>
</span><a name="line-49"></a><span>  </span><a href="Text.ParserCombinators.ReadP.html#option"><span class="hs-identifier hs-var">option</span></a><span class="hs-special">,</span><span>
</span><a name="line-50"></a><span>  </span><a href="Text.ParserCombinators.ReadP.html#optional"><span class="hs-identifier hs-var">optional</span></a><span class="hs-special">,</span><span>
</span><a name="line-51"></a><span>  </span><a href="Text.ParserCombinators.ReadP.html#many"><span class="hs-identifier hs-var">many</span></a><span class="hs-special">,</span><span>
</span><a name="line-52"></a><span>  </span><a href="Text.ParserCombinators.ReadP.html#many1"><span class="hs-identifier hs-var">many1</span></a><span class="hs-special">,</span><span>
</span><a name="line-53"></a><span>  </span><a href="Text.ParserCombinators.ReadP.html#skipMany"><span class="hs-identifier hs-var">skipMany</span></a><span class="hs-special">,</span><span>
</span><a name="line-54"></a><span>  </span><a href="Text.ParserCombinators.ReadP.html#skipMany1"><span class="hs-identifier hs-var">skipMany1</span></a><span class="hs-special">,</span><span>
</span><a name="line-55"></a><span>  </span><a href="Text.ParserCombinators.ReadP.html#sepBy"><span class="hs-identifier hs-var">sepBy</span></a><span class="hs-special">,</span><span>
</span><a name="line-56"></a><span>  </span><a href="Text.ParserCombinators.ReadP.html#sepBy1"><span class="hs-identifier hs-var">sepBy1</span></a><span class="hs-special">,</span><span>
</span><a name="line-57"></a><span>  </span><a href="Text.ParserCombinators.ReadP.html#endBy"><span class="hs-identifier hs-var">endBy</span></a><span class="hs-special">,</span><span>
</span><a name="line-58"></a><span>  </span><a href="Text.ParserCombinators.ReadP.html#endBy1"><span class="hs-identifier hs-var">endBy1</span></a><span class="hs-special">,</span><span>
</span><a name="line-59"></a><span>  </span><a href="Text.ParserCombinators.ReadP.html#chainr"><span class="hs-identifier hs-var">chainr</span></a><span class="hs-special">,</span><span>
</span><a name="line-60"></a><span>  </span><a href="Text.ParserCombinators.ReadP.html#chainl"><span class="hs-identifier hs-var">chainl</span></a><span class="hs-special">,</span><span>
</span><a name="line-61"></a><span>  </span><a href="Text.ParserCombinators.ReadP.html#chainl1"><span class="hs-identifier hs-var">chainl1</span></a><span class="hs-special">,</span><span>
</span><a name="line-62"></a><span>  </span><a href="Text.ParserCombinators.ReadP.html#chainr1"><span class="hs-identifier hs-var">chainr1</span></a><span class="hs-special">,</span><span>
</span><a name="line-63"></a><span>  </span><a href="Text.ParserCombinators.ReadP.html#manyTill"><span class="hs-identifier hs-var">manyTill</span></a><span class="hs-special">,</span><span>
</span><a name="line-64"></a><span>
</span><a name="line-65"></a><span>  </span><span class="hs-comment">-- * Running a parser</span><span>
</span><a name="line-66"></a><span>  </span><a href="Text.ParserCombinators.ReadP.html#ReadS"><span class="hs-identifier hs-type">ReadS</span></a><span class="hs-special">,</span><span>
</span><a name="line-67"></a><span>  </span><a href="Text.ParserCombinators.ReadP.html#readP_to_S"><span class="hs-identifier hs-var">readP_to_S</span></a><span class="hs-special">,</span><span>
</span><a name="line-68"></a><span>  </span><a href="Text.ParserCombinators.ReadP.html#readS_to_P"><span class="hs-identifier hs-var">readS_to_P</span></a><span class="hs-special">,</span><span>
</span><a name="line-69"></a><span>
</span><a name="line-70"></a><span>  </span><span class="hs-comment">-- * Properties</span><span>
</span><a name="line-71"></a><span>  </span><span class="hs-comment">-- $properties</span><span>
</span><a name="line-72"></a><span>  </span><span class="hs-special">)</span><span>
</span><a name="line-73"></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-74"></a><span>
</span><a name="line-75"></a><span class="hs-keyword">import</span><span> </span><a href="GHC.Unicode.html"><span class="hs-identifier">GHC</span><span class="hs-operator">.</span><span class="hs-identifier">Unicode</span></a><span> </span><span class="hs-special">(</span><span> </span><a href="GHC.Unicode.html#isSpace"><span class="hs-identifier hs-var">isSpace</span></a><span> </span><span class="hs-special">)</span><span>
</span><a name="line-76"></a><span class="hs-keyword">import</span><span> </span><a href="GHC.List.html"><span class="hs-identifier">GHC</span><span class="hs-operator">.</span><span class="hs-identifier">List</span></a><span> </span><span class="hs-special">(</span><span> </span><a href="GHC.List.html#replicate"><span class="hs-identifier hs-var">replicate</span></a><span class="hs-special">,</span><span> </span><a href="GHC.List.html#null"><span class="hs-identifier hs-var">null</span></a><span> </span><span class="hs-special">)</span><span>
</span><a name="line-77"></a><span class="hs-keyword">import</span><span> </span><a href="GHC.Base.html"><span class="hs-identifier">GHC</span><span class="hs-operator">.</span><span class="hs-identifier">Base</span></a><span> </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span> </span><a href="GHC.Base.html#many"><span class="hs-identifier hs-var">many</span></a><span> </span><span class="hs-special">)</span><span>
</span><a name="line-78"></a><span>
</span><a name="line-79"></a><span class="hs-keyword">import</span><span> </span><a href="Control.Monad.Fail.html"><span class="hs-identifier">Control</span><span class="hs-operator">.</span><span class="hs-identifier">Monad</span><span class="hs-operator">.</span><span class="hs-identifier">Fail</span></a><span>
</span><a name="line-80"></a><span>
</span><a name="line-81"></a><span class="hs-keyword">infixr</span><span> </span><span class="hs-number">5</span><span> </span><span class="hs-operator">+++</span><span class="hs-special">,</span><span> </span><span class="hs-operator">&lt;++</span><span>
</span><a name="line-82"></a><span>
</span><a name="line-83"></a><span class="hs-comment">------------------------------------------------------------------------</span><span>
</span><a name="line-84"></a><span class="hs-comment">-- ReadS</span><span>
</span><a name="line-85"></a><span>
</span><a name="line-86"></a><span class="hs-comment">-- | A parser for a type @a@, represented as a function that takes a</span><span>
</span><a name="line-87"></a><span class="hs-comment">-- 'String' and returns a list of possible parses as @(a,'String')@ pairs.</span><span>
</span><a name="line-88"></a><span class="hs-comment">--</span><span>
</span><a name="line-89"></a><span class="hs-comment">-- Note that this kind of backtracking parser is very inefficient;</span><span>
</span><a name="line-90"></a><span class="hs-comment">-- reading a large structure may be quite slow (cf 'ReadP').</span><span>
</span><a name="line-91"></a><span class="hs-keyword">type</span><span> </span><a name="ReadS"><a href="Text.ParserCombinators.ReadP.html#ReadS"><span class="hs-identifier">ReadS</span></a></a><span> </span><a name="local-6989586621679060752"><a href="#local-6989586621679060752"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="GHC.Base.html#String"><span class="hs-identifier hs-type">String</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><a href="#local-6989586621679060752"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><a href="GHC.Base.html#String"><span class="hs-identifier hs-type">String</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-92"></a><span>
</span><a name="line-93"></a><span class="hs-comment">-- ---------------------------------------------------------------------------</span><span>
</span><a name="line-94"></a><span class="hs-comment">-- The P type</span><span>
</span><a name="line-95"></a><span class="hs-comment">-- is representation type -- should be kept abstract</span><span>
</span><a name="line-96"></a><span>
</span><a name="line-97"></a><span class="hs-keyword">data</span><span> </span><a name="P"><a href="Text.ParserCombinators.ReadP.html#P"><span class="hs-identifier">P</span></a></a><span> </span><a name="local-6989586621679060751"><a href="#local-6989586621679060751"><span class="hs-identifier">a</span></a></a><span>
</span><a name="line-98"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a name="Get"><a href="Text.ParserCombinators.ReadP.html#Get"><span class="hs-identifier">Get</span></a></a><span> </span><span class="hs-special">(</span><a href="../ghc-prim-0.5.1.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Types.html#Char"><span class="hs-identifier hs-type">Char</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Text.ParserCombinators.ReadP.html#P"><span class="hs-identifier hs-type">P</span></a><span> </span><a href="#local-6989586621679060751"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-99"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="Look"><a href="Text.ParserCombinators.ReadP.html#Look"><span class="hs-identifier">Look</span></a></a><span> </span><span class="hs-special">(</span><a href="GHC.Base.html#String"><span class="hs-identifier hs-type">String</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Text.ParserCombinators.ReadP.html#P"><span class="hs-identifier hs-type">P</span></a><span> </span><a href="#local-6989586621679060751"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-100"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="Fail"><a href="Text.ParserCombinators.ReadP.html#Fail"><span class="hs-identifier">Fail</span></a></a><span>
</span><a name="line-101"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="Result"><a href="Text.ParserCombinators.ReadP.html#Result"><span class="hs-identifier">Result</span></a></a><span> </span><a href="#local-6989586621679060751"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-special">(</span><a href="Text.ParserCombinators.ReadP.html#P"><span class="hs-identifier hs-type">P</span></a><span> </span><a href="#local-6989586621679060751"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-102"></a><span>  </span><span class="hs-glyph">|</span><span> </span><a name="Final"><a href="Text.ParserCombinators.ReadP.html#Final"><span class="hs-identifier">Final</span></a></a><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><a href="#local-6989586621679060751"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><a href="GHC.Base.html#String"><span class="hs-identifier hs-type">String</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-comment">-- invariant: list is non-empty!</span><span>
</span><a name="line-103"></a><span>  </span><span class="hs-keyword">deriving</span><span> </span><a href="GHC.Base.html#Functor"><span class="hs-identifier hs-type">Functor</span></a><span>
</span><a name="line-104"></a><span>
</span><a name="line-105"></a><span class="hs-comment">-- Monad, MonadPlus</span><span>
</span><a name="line-106"></a><span>
</span><a name="line-107"></a><span class="hs-comment">-- | @since 4.5.0.0</span><span>
</span><a name="line-108"></a><span class="hs-keyword">instance</span><span> </span><a href="GHC.Base.html#Applicative"><span class="hs-identifier hs-type">Applicative</span></a><span> </span><a href="Text.ParserCombinators.ReadP.html#P"><span class="hs-identifier hs-type">P</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-109"></a><span>  </span><a name="local-3458764513820541680"><a href="GHC.Base.html#pure"><span class="hs-identifier">pure</span></a></a><span> </span><a name="local-6989586621679060811"><a href="#local-6989586621679060811"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Text.ParserCombinators.ReadP.html#Result"><span class="hs-identifier hs-var">Result</span></a><span> </span><a href="#local-6989586621679060811"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="Text.ParserCombinators.ReadP.html#Fail"><span class="hs-identifier hs-var">Fail</span></a><span>
</span><a name="line-110"></a><span>  </span><span class="hs-special">(</span><a name="local-3458764513820541679"><a href="GHC.Base.html#%3C%2A%3E"><span class="hs-operator">&lt;*&gt;</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="GHC.Base.html#ap"><span class="hs-identifier hs-var">ap</span></a><span>
</span><a name="line-111"></a><span>
</span><a name="line-112"></a><span class="hs-comment">-- | @since 2.01</span><span>
</span><a name="line-113"></a><span class="hs-keyword">instance</span><span> </span><a href="GHC.Base.html#MonadPlus"><span class="hs-identifier hs-type">MonadPlus</span></a><span> </span><a href="Text.ParserCombinators.ReadP.html#P"><span class="hs-identifier hs-type">P</span></a><span>
</span><a name="line-114"></a><span>
</span><a name="line-115"></a><span class="hs-comment">-- | @since 2.01</span><span>
</span><a name="line-116"></a><span class="hs-keyword">instance</span><span> </span><a href="GHC.Base.html#Monad"><span class="hs-identifier hs-type">Monad</span></a><span> </span><a href="Text.ParserCombinators.ReadP.html#P"><span class="hs-identifier hs-type">P</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-117"></a><span>  </span><span class="hs-special">(</span><a href="Text.ParserCombinators.ReadP.html#Get"><span class="hs-identifier hs-var">Get</span></a><span> </span><a name="local-6989586621679060797"><a href="#local-6989586621679060797"><span class="hs-identifier">f</span></a></a><span class="hs-special">)</span><span>      </span><a name="local-3458764513820541099"><a href="GHC.Base.html#%3E%3E%3D"><span class="hs-operator">&gt;&gt;=</span></a></a><span> </span><a name="local-6989586621679060798"><a href="#local-6989586621679060798"><span class="hs-identifier">k</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Text.ParserCombinators.ReadP.html#Get"><span class="hs-identifier hs-var">Get</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679060799"><a href="#local-6989586621679060799"><span class="hs-identifier">c</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679060797"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679060799"><span class="hs-identifier hs-var">c</span></a><span> </span><a href="GHC.Base.html#%3E%3E%3D"><span class="hs-operator hs-var">&gt;&gt;=</span></a><span> </span><a href="#local-6989586621679060798"><span class="hs-identifier hs-var">k</span></a><span class="hs-special">)</span><span>
</span><a name="line-118"></a><span>  </span><span class="hs-special">(</span><a href="Text.ParserCombinators.ReadP.html#Look"><span class="hs-identifier hs-var">Look</span></a><span> </span><a name="local-6989586621679060800"><a href="#local-6989586621679060800"><span class="hs-identifier">f</span></a></a><span class="hs-special">)</span><span>     </span><span class="hs-operator">&gt;&gt;=</span><span> </span><a name="local-6989586621679060801"><a href="#local-6989586621679060801"><span class="hs-identifier">k</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Text.ParserCombinators.ReadP.html#Look"><span class="hs-identifier hs-var">Look</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679060802"><a href="#local-6989586621679060802"><span class="hs-identifier">s</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679060800"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679060802"><span class="hs-identifier hs-var">s</span></a><span> </span><a href="GHC.Base.html#%3E%3E%3D"><span class="hs-operator hs-var">&gt;&gt;=</span></a><span> </span><a href="#local-6989586621679060801"><span class="hs-identifier hs-var">k</span></a><span class="hs-special">)</span><span>
</span><a name="line-119"></a><span>  </span><a href="Text.ParserCombinators.ReadP.html#Fail"><span class="hs-identifier hs-var">Fail</span></a><span>         </span><span class="hs-operator">&gt;&gt;=</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Text.ParserCombinators.ReadP.html#Fail"><span class="hs-identifier hs-var">Fail</span></a><span>
</span><a name="line-120"></a><span>  </span><span class="hs-special">(</span><a href="Text.ParserCombinators.ReadP.html#Result"><span class="hs-identifier hs-var">Result</span></a><span> </span><a name="local-6989586621679060803"><a href="#local-6989586621679060803"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621679060804"><a href="#local-6989586621679060804"><span class="hs-identifier">p</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-operator">&gt;&gt;=</span><span> </span><a name="local-6989586621679060805"><a href="#local-6989586621679060805"><span class="hs-identifier">k</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679060805"><span class="hs-identifier hs-var">k</span></a><span> </span><a href="#local-6989586621679060803"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="GHC.Base.html#%3C%7C%3E"><span class="hs-operator hs-var">&lt;|&gt;</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679060804"><span class="hs-identifier hs-var">p</span></a><span> </span><a href="GHC.Base.html#%3E%3E%3D"><span class="hs-operator hs-var">&gt;&gt;=</span></a><span> </span><a href="#local-6989586621679060805"><span class="hs-identifier hs-var">k</span></a><span class="hs-special">)</span><span>
</span><a name="line-121"></a><span>  </span><span class="hs-special">(</span><a href="Text.ParserCombinators.ReadP.html#Final"><span class="hs-identifier hs-var">Final</span></a><span> </span><a name="local-6989586621679060806"><a href="#local-6989586621679060806"><span class="hs-identifier">r</span></a></a><span class="hs-special">)</span><span>    </span><span class="hs-operator">&gt;&gt;=</span><span> </span><a name="local-6989586621679060807"><a href="#local-6989586621679060807"><span class="hs-identifier">k</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Text.ParserCombinators.ReadP.html#final"><span class="hs-identifier hs-var">final</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621679060810"><span class="hs-identifier hs-var">ys'</span></a><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679060808"><a href="#local-6989586621679060808"><span class="hs-identifier">x</span></a></a><span class="hs-special">,</span><a name="local-6989586621679060809"><a href="#local-6989586621679060809"><span class="hs-identifier">s</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679060806"><span class="hs-identifier hs-var">r</span></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679060810"><a href="#local-6989586621679060810"><span class="hs-identifier">ys'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Text.ParserCombinators.ReadP.html#run"><span class="hs-identifier hs-var">run</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679060807"><span class="hs-identifier hs-var">k</span></a><span> </span><a href="#local-6989586621679060808"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679060809"><span class="hs-identifier hs-var">s</span></a><span class="hs-special">]</span><span>
</span><a name="line-122"></a><span>
</span><a name="line-123"></a><span>  </span><a name="local-3458764513820541098"><a href="GHC.Base.html#fail"><span class="hs-identifier">fail</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Text.ParserCombinators.ReadP.html#Fail"><span class="hs-identifier hs-var">Fail</span></a><span>
</span><a name="line-124"></a><span>
</span><a name="line-125"></a><span class="hs-comment">-- | @since 4.9.0.0</span><span>
</span><a name="line-126"></a><span class="hs-keyword">instance</span><span> </span><a href="Control.Monad.Fail.html#MonadFail"><span class="hs-identifier hs-type">MonadFail</span></a><span> </span><a href="Text.ParserCombinators.ReadP.html#P"><span class="hs-identifier hs-type">P</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-127"></a><span>  </span><a name="local-3458764513820541104"><a href="Control.Monad.Fail.html#fail"><span class="hs-identifier">fail</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Text.ParserCombinators.ReadP.html#Fail"><span class="hs-identifier hs-var">Fail</span></a><span>
</span><a name="line-128"></a><span>
</span><a name="line-129"></a><span class="hs-comment">-- | @since 4.5.0.0</span><span>
</span><a name="line-130"></a><span class="hs-keyword">instance</span><span> </span><a href="GHC.Base.html#Alternative"><span class="hs-identifier hs-type">Alternative</span></a><span> </span><a href="Text.ParserCombinators.ReadP.html#P"><span class="hs-identifier hs-type">P</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-131"></a><span>  </span><a name="local-8214565720323792498"><a href="GHC.Base.html#empty"><span class="hs-identifier">empty</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Text.ParserCombinators.ReadP.html#Fail"><span class="hs-identifier hs-var">Fail</span></a><span>
</span><a name="line-132"></a><span>
</span><a name="line-133"></a><span>  </span><span class="hs-comment">-- most common case: two gets are combined</span><span>
</span><a name="line-134"></a><span>  </span><a href="Text.ParserCombinators.ReadP.html#Get"><span class="hs-identifier hs-var">Get</span></a><span> </span><a name="local-6989586621679060763"><a href="#local-6989586621679060763"><span class="hs-identifier">f1</span></a></a><span>     </span><a name="local-8214565720323792499"><a href="GHC.Base.html#%3C%7C%3E"><span class="hs-operator">&lt;|&gt;</span></a></a><span> </span><a href="Text.ParserCombinators.ReadP.html#Get"><span class="hs-identifier hs-var">Get</span></a><span> </span><a name="local-6989586621679060764"><a href="#local-6989586621679060764"><span class="hs-identifier">f2</span></a></a><span>     </span><span class="hs-glyph">=</span><span> </span><a href="Text.ParserCombinators.ReadP.html#Get"><span class="hs-identifier hs-var">Get</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679060765"><a href="#local-6989586621679060765"><span class="hs-identifier">c</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679060763"><span class="hs-identifier hs-var">f1</span></a><span> </span><a href="#local-6989586621679060765"><span class="hs-identifier hs-var">c</span></a><span> </span><a href="GHC.Base.html#%3C%7C%3E"><span class="hs-operator hs-var">&lt;|&gt;</span></a><span> </span><a href="#local-6989586621679060764"><span class="hs-identifier hs-var">f2</span></a><span> </span><a href="#local-6989586621679060765"><span class="hs-identifier hs-var">c</span></a><span class="hs-special">)</span><span>
</span><a name="line-135"></a><span>
</span><a name="line-136"></a><span>  </span><span class="hs-comment">-- results are delivered as soon as possible</span><span>
</span><a name="line-137"></a><span>  </span><a href="Text.ParserCombinators.ReadP.html#Result"><span class="hs-identifier hs-var">Result</span></a><span> </span><a name="local-6989586621679060766"><a href="#local-6989586621679060766"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621679060767"><a href="#local-6989586621679060767"><span class="hs-identifier">p</span></a></a><span> </span><span class="hs-operator">&lt;|&gt;</span><span> </span><a name="local-6989586621679060768"><a href="#local-6989586621679060768"><span class="hs-identifier">q</span></a></a><span>          </span><span class="hs-glyph">=</span><span> </span><a href="Text.ParserCombinators.ReadP.html#Result"><span class="hs-identifier hs-var">Result</span></a><span> </span><a href="#local-6989586621679060766"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679060767"><span class="hs-identifier hs-var">p</span></a><span> </span><a href="GHC.Base.html#%3C%7C%3E"><span class="hs-operator hs-var">&lt;|&gt;</span></a><span> </span><a href="#local-6989586621679060768"><span class="hs-identifier hs-var">q</span></a><span class="hs-special">)</span><span>
</span><a name="line-138"></a><span>  </span><a name="local-6989586621679060769"><a href="#local-6989586621679060769"><span class="hs-identifier">p</span></a></a><span>          </span><span class="hs-operator">&lt;|&gt;</span><span> </span><a href="Text.ParserCombinators.ReadP.html#Result"><span class="hs-identifier hs-var">Result</span></a><span> </span><a name="local-6989586621679060770"><a href="#local-6989586621679060770"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621679060771"><a href="#local-6989586621679060771"><span class="hs-identifier">q</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Text.ParserCombinators.ReadP.html#Result"><span class="hs-identifier hs-var">Result</span></a><span> </span><a href="#local-6989586621679060770"><span class="hs-identifier hs-var">x</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679060769"><span class="hs-identifier hs-var">p</span></a><span> </span><a href="GHC.Base.html#%3C%7C%3E"><span class="hs-operator hs-var">&lt;|&gt;</span></a><span> </span><a href="#local-6989586621679060771"><span class="hs-identifier hs-var">q</span></a><span class="hs-special">)</span><span>
</span><a name="line-139"></a><span>
</span><a name="line-140"></a><span>  </span><span class="hs-comment">-- fail disappears</span><span>
</span><a name="line-141"></a><span>  </span><a href="Text.ParserCombinators.ReadP.html#Fail"><span class="hs-identifier hs-var">Fail</span></a><span>       </span><span class="hs-operator">&lt;|&gt;</span><span> </span><a name="local-6989586621679060772"><a href="#local-6989586621679060772"><span class="hs-identifier">p</span></a></a><span>          </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679060772"><span class="hs-identifier hs-var">p</span></a><span>
</span><a name="line-142"></a><span>  </span><a name="local-6989586621679060773"><a href="#local-6989586621679060773"><span class="hs-identifier">p</span></a></a><span>          </span><span class="hs-operator">&lt;|&gt;</span><span> </span><a href="Text.ParserCombinators.ReadP.html#Fail"><span class="hs-identifier hs-var">Fail</span></a><span>       </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679060773"><span class="hs-identifier hs-var">p</span></a><span>
</span><a name="line-143"></a><span>
</span><a name="line-144"></a><span>  </span><span class="hs-comment">-- two finals are combined</span><span>
</span><a name="line-145"></a><span>  </span><span class="hs-comment">-- final + look becomes one look and one final (=optimization)</span><span>
</span><a name="line-146"></a><span>  </span><span class="hs-comment">-- final + sthg else becomes one look and one final</span><span>
</span><a name="line-147"></a><span>  </span><a href="Text.ParserCombinators.ReadP.html#Final"><span class="hs-identifier hs-var">Final</span></a><span> </span><a name="local-6989586621679060774"><a href="#local-6989586621679060774"><span class="hs-identifier">r</span></a></a><span>    </span><span class="hs-operator">&lt;|&gt;</span><span> </span><a href="Text.ParserCombinators.ReadP.html#Final"><span class="hs-identifier hs-var">Final</span></a><span> </span><a name="local-6989586621679060775"><a href="#local-6989586621679060775"><span class="hs-identifier">t</span></a></a><span>    </span><span class="hs-glyph">=</span><span> </span><a href="Text.ParserCombinators.ReadP.html#Final"><span class="hs-identifier hs-var">Final</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679060774"><span class="hs-identifier hs-var">r</span></a><span> </span><a href="GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a><span> </span><a href="#local-6989586621679060775"><span class="hs-identifier hs-var">t</span></a><span class="hs-special">)</span><span>
</span><a name="line-148"></a><span>  </span><a href="Text.ParserCombinators.ReadP.html#Final"><span class="hs-identifier hs-var">Final</span></a><span> </span><a name="local-6989586621679060776"><a href="#local-6989586621679060776"><span class="hs-identifier">r</span></a></a><span>    </span><span class="hs-operator">&lt;|&gt;</span><span> </span><a href="Text.ParserCombinators.ReadP.html#Look"><span class="hs-identifier hs-var">Look</span></a><span> </span><a name="local-6989586621679060777"><a href="#local-6989586621679060777"><span class="hs-identifier">f</span></a></a><span>     </span><span class="hs-glyph">=</span><span> </span><a href="Text.ParserCombinators.ReadP.html#Look"><span class="hs-identifier hs-var">Look</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679060778"><a href="#local-6989586621679060778"><span class="hs-identifier">s</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Text.ParserCombinators.ReadP.html#Final"><span class="hs-identifier hs-var">Final</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679060776"><span class="hs-identifier hs-var">r</span></a><span> </span><a href="GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a><span> </span><a href="Text.ParserCombinators.ReadP.html#run"><span class="hs-identifier hs-var">run</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679060777"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679060778"><span class="hs-identifier hs-var">s</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679060778"><span class="hs-identifier hs-var">s</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-149"></a><span>  </span><a href="Text.ParserCombinators.ReadP.html#Final"><span class="hs-identifier hs-var">Final</span></a><span> </span><a name="local-6989586621679060779"><a href="#local-6989586621679060779"><span class="hs-identifier">r</span></a></a><span>    </span><span class="hs-operator">&lt;|&gt;</span><span> </span><a name="local-6989586621679060780"><a href="#local-6989586621679060780"><span class="hs-identifier">p</span></a></a><span>          </span><span class="hs-glyph">=</span><span> </span><a href="Text.ParserCombinators.ReadP.html#Look"><span class="hs-identifier hs-var">Look</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679060781"><a href="#local-6989586621679060781"><span class="hs-identifier">s</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Text.ParserCombinators.ReadP.html#Final"><span class="hs-identifier hs-var">Final</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679060779"><span class="hs-identifier hs-var">r</span></a><span> </span><a href="GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a><span> </span><a href="Text.ParserCombinators.ReadP.html#run"><span class="hs-identifier hs-var">run</span></a><span> </span><a href="#local-6989586621679060780"><span class="hs-identifier hs-var">p</span></a><span> </span><a href="#local-6989586621679060781"><span class="hs-identifier hs-var">s</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-150"></a><span>  </span><a href="Text.ParserCombinators.ReadP.html#Look"><span class="hs-identifier hs-var">Look</span></a><span> </span><a name="local-6989586621679060782"><a href="#local-6989586621679060782"><span class="hs-identifier">f</span></a></a><span>     </span><span class="hs-operator">&lt;|&gt;</span><span> </span><a href="Text.ParserCombinators.ReadP.html#Final"><span class="hs-identifier hs-var">Final</span></a><span> </span><a name="local-6989586621679060783"><a href="#local-6989586621679060783"><span class="hs-identifier">r</span></a></a><span>    </span><span class="hs-glyph">=</span><span> </span><a href="Text.ParserCombinators.ReadP.html#Look"><span class="hs-identifier hs-var">Look</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679060784"><a href="#local-6989586621679060784"><span class="hs-identifier">s</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Text.ParserCombinators.ReadP.html#Final"><span class="hs-identifier hs-var">Final</span></a><span> </span><span class="hs-special">(</span><a href="Text.ParserCombinators.ReadP.html#run"><span class="hs-identifier hs-var">run</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679060782"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679060784"><span class="hs-identifier hs-var">s</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679060784"><span class="hs-identifier hs-var">s</span></a><span> </span><a href="GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a><span> </span><a href="#local-6989586621679060783"><span class="hs-identifier hs-var">r</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-151"></a><span>  </span><a name="local-6989586621679060785"><a href="#local-6989586621679060785"><span class="hs-identifier">p</span></a></a><span>          </span><span class="hs-operator">&lt;|&gt;</span><span> </span><a href="Text.ParserCombinators.ReadP.html#Final"><span class="hs-identifier hs-var">Final</span></a><span> </span><a name="local-6989586621679060786"><a href="#local-6989586621679060786"><span class="hs-identifier">r</span></a></a><span>    </span><span class="hs-glyph">=</span><span> </span><a href="Text.ParserCombinators.ReadP.html#Look"><span class="hs-identifier hs-var">Look</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679060787"><a href="#local-6989586621679060787"><span class="hs-identifier">s</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Text.ParserCombinators.ReadP.html#Final"><span class="hs-identifier hs-var">Final</span></a><span> </span><span class="hs-special">(</span><a href="Text.ParserCombinators.ReadP.html#run"><span class="hs-identifier hs-var">run</span></a><span> </span><a href="#local-6989586621679060785"><span class="hs-identifier hs-var">p</span></a><span> </span><a href="#local-6989586621679060787"><span class="hs-identifier hs-var">s</span></a><span> </span><a href="GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a><span> </span><a href="#local-6989586621679060786"><span class="hs-identifier hs-var">r</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-152"></a><span>
</span><a name="line-153"></a><span>  </span><span class="hs-comment">-- two looks are combined (=optimization)</span><span>
</span><a name="line-154"></a><span>  </span><span class="hs-comment">-- look + sthg else floats upwards</span><span>
</span><a name="line-155"></a><span>  </span><a href="Text.ParserCombinators.ReadP.html#Look"><span class="hs-identifier hs-var">Look</span></a><span> </span><a name="local-6989586621679060788"><a href="#local-6989586621679060788"><span class="hs-identifier">f</span></a></a><span>     </span><span class="hs-operator">&lt;|&gt;</span><span> </span><a href="Text.ParserCombinators.ReadP.html#Look"><span class="hs-identifier hs-var">Look</span></a><span> </span><a name="local-6989586621679060789"><a href="#local-6989586621679060789"><span class="hs-identifier">g</span></a></a><span>     </span><span class="hs-glyph">=</span><span> </span><a href="Text.ParserCombinators.ReadP.html#Look"><span class="hs-identifier hs-var">Look</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679060790"><a href="#local-6989586621679060790"><span class="hs-identifier">s</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679060788"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679060790"><span class="hs-identifier hs-var">s</span></a><span> </span><a href="GHC.Base.html#%3C%7C%3E"><span class="hs-operator hs-var">&lt;|&gt;</span></a><span> </span><a href="#local-6989586621679060789"><span class="hs-identifier hs-var">g</span></a><span> </span><a href="#local-6989586621679060790"><span class="hs-identifier hs-var">s</span></a><span class="hs-special">)</span><span>
</span><a name="line-156"></a><span>  </span><a href="Text.ParserCombinators.ReadP.html#Look"><span class="hs-identifier hs-var">Look</span></a><span> </span><a name="local-6989586621679060791"><a href="#local-6989586621679060791"><span class="hs-identifier">f</span></a></a><span>     </span><span class="hs-operator">&lt;|&gt;</span><span> </span><a name="local-6989586621679060792"><a href="#local-6989586621679060792"><span class="hs-identifier">p</span></a></a><span>          </span><span class="hs-glyph">=</span><span> </span><a href="Text.ParserCombinators.ReadP.html#Look"><span class="hs-identifier hs-var">Look</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679060793"><a href="#local-6989586621679060793"><span class="hs-identifier">s</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679060791"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679060793"><span class="hs-identifier hs-var">s</span></a><span> </span><a href="GHC.Base.html#%3C%7C%3E"><span class="hs-operator hs-var">&lt;|&gt;</span></a><span> </span><a href="#local-6989586621679060792"><span class="hs-identifier hs-var">p</span></a><span class="hs-special">)</span><span>
</span><a name="line-157"></a><span>  </span><a name="local-6989586621679060794"><a href="#local-6989586621679060794"><span class="hs-identifier">p</span></a></a><span>          </span><span class="hs-operator">&lt;|&gt;</span><span> </span><a href="Text.ParserCombinators.ReadP.html#Look"><span class="hs-identifier hs-var">Look</span></a><span> </span><a name="local-6989586621679060795"><a href="#local-6989586621679060795"><span class="hs-identifier">f</span></a></a><span>     </span><span class="hs-glyph">=</span><span> </span><a href="Text.ParserCombinators.ReadP.html#Look"><span class="hs-identifier hs-var">Look</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679060796"><a href="#local-6989586621679060796"><span class="hs-identifier">s</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679060794"><span class="hs-identifier hs-var">p</span></a><span> </span><a href="GHC.Base.html#%3C%7C%3E"><span class="hs-operator hs-var">&lt;|&gt;</span></a><span> </span><a href="#local-6989586621679060795"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679060796"><span class="hs-identifier hs-var">s</span></a><span class="hs-special">)</span><span>
</span><a name="line-158"></a><span>
</span><a name="line-159"></a><span class="hs-comment">-- ---------------------------------------------------------------------------</span><span>
</span><a name="line-160"></a><span class="hs-comment">-- The ReadP type</span><span>
</span><a name="line-161"></a><span>
</span><a name="line-162"></a><span class="hs-keyword">newtype</span><span> </span><a name="ReadP"><a href="Text.ParserCombinators.ReadP.html#ReadP"><span class="hs-identifier">ReadP</span></a></a><span> </span><a name="local-6989586621679060749"><a href="#local-6989586621679060749"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="R"><a href="Text.ParserCombinators.ReadP.html#R"><span class="hs-identifier">R</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-keyword">forall</span><span> </span><a name="local-6989586621679060750"><a href="#local-6989586621679060750"><span class="hs-identifier">b</span></a></a><span> </span><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679060749"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Text.ParserCombinators.ReadP.html#P"><span class="hs-identifier hs-type">P</span></a><span> </span><a href="#local-6989586621679060750"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Text.ParserCombinators.ReadP.html#P"><span class="hs-identifier hs-type">P</span></a><span> </span><a href="#local-6989586621679060750"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span>
</span><a name="line-163"></a><span>
</span><a name="line-164"></a><span class="hs-comment">-- Functor, Monad, MonadPlus</span><span>
</span><a name="line-165"></a><span>
</span><a name="line-166"></a><span class="hs-comment">-- | @since 2.01</span><span>
</span><a name="line-167"></a><span class="hs-keyword">instance</span><span> </span><a href="GHC.Base.html#Functor"><span class="hs-identifier hs-type">Functor</span></a><span> </span><a href="Text.ParserCombinators.ReadP.html#ReadP"><span class="hs-identifier hs-type">ReadP</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-168"></a><span>  </span><a name="local-3458764513820541101"><a href="GHC.Base.html#fmap"><span class="hs-identifier">fmap</span></a></a><span> </span><a name="local-6989586621679060760"><a href="#local-6989586621679060760"><span class="hs-identifier">h</span></a></a><span> </span><span class="hs-special">(</span><a href="Text.ParserCombinators.ReadP.html#R"><span class="hs-identifier hs-var">R</span></a><span> </span><a name="local-6989586621679060761"><a href="#local-6989586621679060761"><span class="hs-identifier">f</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Text.ParserCombinators.ReadP.html#R"><span class="hs-identifier hs-var">R</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679060762"><a href="#local-6989586621679060762"><span class="hs-identifier">k</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679060761"><span class="hs-identifier hs-var">f</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679060762"><span class="hs-identifier hs-var">k</span></a><span> </span><a href="GHC.Base.html#."><span class="hs-operator hs-var">.</span></a><span> </span><a href="#local-6989586621679060760"><span class="hs-identifier hs-var">h</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-169"></a><span>
</span><a name="line-170"></a><span class="hs-comment">-- | @since 4.6.0.0</span><span>
</span><a name="line-171"></a><span class="hs-keyword">instance</span><span> </span><a href="GHC.Base.html#Applicative"><span class="hs-identifier hs-type">Applicative</span></a><span> </span><a href="Text.ParserCombinators.ReadP.html#ReadP"><span class="hs-identifier hs-type">ReadP</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-172"></a><span>    </span><a name="local-3458764513820541680"><a href="GHC.Base.html#pure"><span class="hs-identifier">pure</span></a></a><span> </span><a name="local-6989586621679060758"><a href="#local-6989586621679060758"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Text.ParserCombinators.ReadP.html#R"><span class="hs-identifier hs-var">R</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679060759"><a href="#local-6989586621679060759"><span class="hs-identifier">k</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679060759"><span class="hs-identifier hs-var">k</span></a><span> </span><a href="#local-6989586621679060758"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span>
</span><a name="line-173"></a><span>    </span><span class="hs-special">(</span><a name="local-3458764513820541679"><a href="GHC.Base.html#%3C%2A%3E"><span class="hs-operator">&lt;*&gt;</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="GHC.Base.html#ap"><span class="hs-identifier hs-var">ap</span></a><span>
</span><a name="line-174"></a><span>    </span><a name="local-8214565720323792502"><a href="GHC.Base.html#liftA2"><span class="hs-identifier">liftA2</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="GHC.Base.html#liftM2"><span class="hs-identifier hs-var">liftM2</span></a><span>
</span><a name="line-175"></a><span>
</span><a name="line-176"></a><span class="hs-comment">-- | @since 2.01</span><span>
</span><a name="line-177"></a><span class="hs-keyword">instance</span><span> </span><a href="GHC.Base.html#Monad"><span class="hs-identifier hs-type">Monad</span></a><span> </span><a href="Text.ParserCombinators.ReadP.html#ReadP"><span class="hs-identifier hs-type">ReadP</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-178"></a><span>  </span><a name="local-3458764513820541098"><a href="GHC.Base.html#fail"><span class="hs-identifier">fail</span></a></a><span> </span><span class="hs-identifier">_</span><span>    </span><span class="hs-glyph">=</span><span> </span><a href="Text.ParserCombinators.ReadP.html#R"><span class="hs-identifier hs-var">R</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Text.ParserCombinators.ReadP.html#Fail"><span class="hs-identifier hs-var">Fail</span></a><span class="hs-special">)</span><span>
</span><a name="line-179"></a><span>  </span><a href="Text.ParserCombinators.ReadP.html#R"><span class="hs-identifier hs-var">R</span></a><span> </span><a name="local-6989586621679060753"><a href="#local-6989586621679060753"><span class="hs-identifier">m</span></a></a><span> </span><a name="local-3458764513820541099"><a href="GHC.Base.html#%3E%3E%3D"><span class="hs-operator">&gt;&gt;=</span></a></a><span> </span><a name="local-6989586621679060754"><a href="#local-6989586621679060754"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Text.ParserCombinators.ReadP.html#R"><span class="hs-identifier hs-var">R</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679060755"><a href="#local-6989586621679060755"><span class="hs-identifier">k</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679060753"><span class="hs-identifier hs-var">m</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679060756"><a href="#local-6989586621679060756"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">let</span><span> </span><a href="Text.ParserCombinators.ReadP.html#R"><span class="hs-identifier hs-var">R</span></a><span> </span><a name="local-6989586621679060757"><a href="#local-6989586621679060757"><span class="hs-identifier">m'</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679060754"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679060756"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-keyword">in</span><span> </span><a href="#local-6989586621679060757"><span class="hs-identifier hs-var">m'</span></a><span> </span><a href="#local-6989586621679060755"><span class="hs-identifier hs-var">k</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-180"></a><span>
</span><a name="line-181"></a><span class="hs-comment">-- | @since 4.9.0.0</span><span>
</span><a name="line-182"></a><span class="hs-keyword">instance</span><span> </span><a href="Control.Monad.Fail.html#MonadFail"><span class="hs-identifier hs-type">MonadFail</span></a><span> </span><a href="Text.ParserCombinators.ReadP.html#ReadP"><span class="hs-identifier hs-type">ReadP</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-183"></a><span>  </span><a name="local-3458764513820541104"><a href="Control.Monad.Fail.html#fail"><span class="hs-identifier">fail</span></a></a><span> </span><span class="hs-identifier">_</span><span>    </span><span class="hs-glyph">=</span><span> </span><a href="Text.ParserCombinators.ReadP.html#R"><span class="hs-identifier hs-var">R</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Text.ParserCombinators.ReadP.html#Fail"><span class="hs-identifier hs-var">Fail</span></a><span class="hs-special">)</span><span>
</span><a name="line-184"></a><span>
</span><a name="line-185"></a><span class="hs-comment">-- | @since 4.6.0.0</span><span>
</span><a name="line-186"></a><span class="hs-keyword">instance</span><span> </span><a href="GHC.Base.html#Alternative"><span class="hs-identifier hs-type">Alternative</span></a><span> </span><a href="Text.ParserCombinators.ReadP.html#ReadP"><span class="hs-identifier hs-type">ReadP</span></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-187"></a><span>  </span><a name="local-8214565720323792498"><a href="GHC.Base.html#empty"><span class="hs-identifier">empty</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Text.ParserCombinators.ReadP.html#pfail"><span class="hs-identifier hs-var">pfail</span></a><span>
</span><a name="line-188"></a><span>  </span><span class="hs-special">(</span><a name="local-8214565720323792499"><a href="GHC.Base.html#%3C%7C%3E"><span class="hs-operator">&lt;|&gt;</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="Text.ParserCombinators.ReadP.html#%2B%2B%2B"><span class="hs-operator hs-var">+++</span></a><span class="hs-special">)</span><span>
</span><a name="line-189"></a><span>
</span><a name="line-190"></a><span class="hs-comment">-- | @since 2.01</span><span>
</span><a name="line-191"></a><span class="hs-keyword">instance</span><span> </span><a href="GHC.Base.html#MonadPlus"><span class="hs-identifier hs-type">MonadPlus</span></a><span> </span><a href="Text.ParserCombinators.ReadP.html#ReadP"><span class="hs-identifier hs-type">ReadP</span></a><span>
</span><a name="line-192"></a><span>
</span><a name="line-193"></a><span class="hs-comment">-- ---------------------------------------------------------------------------</span><span>
</span><a name="line-194"></a><span class="hs-comment">-- Operations over P</span><span>
</span><a name="line-195"></a><span>
</span><a name="line-196"></a><span class="hs-identifier">final</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><a href="#local-6989586621679060844"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">,</span><a href="GHC.Base.html#String"><span class="hs-identifier hs-type">String</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Text.ParserCombinators.ReadP.html#P"><span class="hs-identifier hs-type">P</span></a><span> </span><a href="#local-6989586621679060844"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-197"></a><span class="hs-comment">-- Maintains invariant for Final constructor</span><span>
</span><a name="line-198"></a><a name="final"><a href="Text.ParserCombinators.ReadP.html#final"><span class="hs-identifier">final</span></a></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Text.ParserCombinators.ReadP.html#Fail"><span class="hs-identifier hs-var">Fail</span></a><span>
</span><a name="line-199"></a><span class="hs-identifier">final</span><span> </span><a name="local-6989586621679060845"><a href="#local-6989586621679060845"><span class="hs-identifier">r</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Text.ParserCombinators.ReadP.html#Final"><span class="hs-identifier hs-var">Final</span></a><span> </span><a href="#local-6989586621679060845"><span class="hs-identifier hs-var">r</span></a><span>
</span><a name="line-200"></a><span>
</span><a name="line-201"></a><span class="hs-identifier">run</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Text.ParserCombinators.ReadP.html#P"><span class="hs-identifier hs-type">P</span></a><span> </span><a href="#local-6989586621679060843"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Text.ParserCombinators.ReadP.html#ReadS"><span class="hs-identifier hs-type">ReadS</span></a><span> </span><a href="#local-6989586621679060843"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-202"></a><a name="run"><a href="Text.ParserCombinators.ReadP.html#run"><span class="hs-identifier">run</span></a></a><span> </span><span class="hs-special">(</span><a href="Text.ParserCombinators.ReadP.html#Get"><span class="hs-identifier hs-var">Get</span></a><span> </span><a name="local-6989586621679060846"><a href="#local-6989586621679060846"><span class="hs-identifier">f</span></a></a><span class="hs-special">)</span><span>      </span><span class="hs-special">(</span><a name="local-6989586621679060847"><a href="#local-6989586621679060847"><span class="hs-identifier">c</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679060848"><a href="#local-6989586621679060848"><span class="hs-identifier">s</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Text.ParserCombinators.ReadP.html#run"><span class="hs-identifier hs-var">run</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679060846"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679060847"><span class="hs-identifier hs-var">c</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679060848"><span class="hs-identifier hs-var">s</span></a><span>
</span><a name="line-203"></a><span class="hs-identifier">run</span><span> </span><span class="hs-special">(</span><a href="Text.ParserCombinators.ReadP.html#Look"><span class="hs-identifier hs-var">Look</span></a><span> </span><a name="local-6989586621679060849"><a href="#local-6989586621679060849"><span class="hs-identifier">f</span></a></a><span class="hs-special">)</span><span>     </span><a name="local-6989586621679060850"><a href="#local-6989586621679060850"><span class="hs-identifier">s</span></a></a><span>     </span><span class="hs-glyph">=</span><span> </span><a href="Text.ParserCombinators.ReadP.html#run"><span class="hs-identifier hs-var">run</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679060849"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679060850"><span class="hs-identifier hs-var">s</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679060850"><span class="hs-identifier hs-var">s</span></a><span>
</span><a name="line-204"></a><span class="hs-identifier">run</span><span> </span><span class="hs-special">(</span><a href="Text.ParserCombinators.ReadP.html#Result"><span class="hs-identifier hs-var">Result</span></a><span> </span><a name="local-6989586621679060851"><a href="#local-6989586621679060851"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621679060852"><a href="#local-6989586621679060852"><span class="hs-identifier">p</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679060853"><a href="#local-6989586621679060853"><span class="hs-identifier">s</span></a></a><span>     </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679060851"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">,</span><a href="#local-6989586621679060853"><span class="hs-identifier hs-var">s</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">:</span><span> </span><a href="Text.ParserCombinators.ReadP.html#run"><span class="hs-identifier hs-var">run</span></a><span> </span><a href="#local-6989586621679060852"><span class="hs-identifier hs-var">p</span></a><span> </span><a href="#local-6989586621679060853"><span class="hs-identifier hs-var">s</span></a><span>
</span><a name="line-205"></a><span class="hs-identifier">run</span><span> </span><span class="hs-special">(</span><a href="Text.ParserCombinators.ReadP.html#Final"><span class="hs-identifier hs-var">Final</span></a><span> </span><a name="local-6989586621679060854"><a href="#local-6989586621679060854"><span class="hs-identifier">r</span></a></a><span class="hs-special">)</span><span>    </span><span class="hs-identifier">_</span><span>     </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679060854"><span class="hs-identifier hs-var">r</span></a><span>
</span><a name="line-206"></a><span class="hs-identifier">run</span><span> </span><span class="hs-identifier">_</span><span>            </span><span class="hs-identifier">_</span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-207"></a><span>
</span><a name="line-208"></a><span class="hs-comment">-- ---------------------------------------------------------------------------</span><span>
</span><a name="line-209"></a><span class="hs-comment">-- Operations over ReadP</span><span>
</span><a name="line-210"></a><span>
</span><a name="line-211"></a><span class="hs-identifier">get</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Text.ParserCombinators.ReadP.html#ReadP"><span class="hs-identifier hs-type">ReadP</span></a><span> </span><a href="../ghc-prim-0.5.1.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Types.html#Char"><span class="hs-identifier hs-type">Char</span></a><span>
</span><a name="line-212"></a><span class="hs-comment">-- ^ Consumes and returns the next character.</span><span>
</span><a name="line-213"></a><span class="hs-comment">--   Fails if there is no input left.</span><span>
</span><a name="line-214"></a><a name="get"><a href="Text.ParserCombinators.ReadP.html#get"><span class="hs-identifier">get</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Text.ParserCombinators.ReadP.html#R"><span class="hs-identifier hs-var">R</span></a><span> </span><a href="Text.ParserCombinators.ReadP.html#Get"><span class="hs-identifier hs-var">Get</span></a><span>
</span><a name="line-215"></a><span>
</span><a name="line-216"></a><span class="hs-identifier">look</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Text.ParserCombinators.ReadP.html#ReadP"><span class="hs-identifier hs-type">ReadP</span></a><span> </span><a href="GHC.Base.html#String"><span class="hs-identifier hs-type">String</span></a><span>
</span><a name="line-217"></a><span class="hs-comment">-- ^ Look-ahead: returns the part of the input that is left, without</span><span>
</span><a name="line-218"></a><span class="hs-comment">--   consuming it.</span><span>
</span><a name="line-219"></a><a name="look"><a href="Text.ParserCombinators.ReadP.html#look"><span class="hs-identifier">look</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Text.ParserCombinators.ReadP.html#R"><span class="hs-identifier hs-var">R</span></a><span> </span><a href="Text.ParserCombinators.ReadP.html#Look"><span class="hs-identifier hs-var">Look</span></a><span>
</span><a name="line-220"></a><span>
</span><a name="line-221"></a><span class="hs-identifier">pfail</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Text.ParserCombinators.ReadP.html#ReadP"><span class="hs-identifier hs-type">ReadP</span></a><span> </span><a href="#local-6989586621679060842"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-222"></a><span class="hs-comment">-- ^ Always fails.</span><span>
</span><a name="line-223"></a><a name="pfail"><a href="Text.ParserCombinators.ReadP.html#pfail"><span class="hs-identifier">pfail</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Text.ParserCombinators.ReadP.html#R"><span class="hs-identifier hs-var">R</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Text.ParserCombinators.ReadP.html#Fail"><span class="hs-identifier hs-var">Fail</span></a><span class="hs-special">)</span><span>
</span><a name="line-224"></a><span>
</span><a name="line-225"></a><span class="hs-special">(</span><span class="hs-operator">+++</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Text.ParserCombinators.ReadP.html#ReadP"><span class="hs-identifier hs-type">ReadP</span></a><span> </span><a href="#local-6989586621679060841"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Text.ParserCombinators.ReadP.html#ReadP"><span class="hs-identifier hs-type">ReadP</span></a><span> </span><a href="#local-6989586621679060841"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Text.ParserCombinators.ReadP.html#ReadP"><span class="hs-identifier hs-type">ReadP</span></a><span> </span><a href="#local-6989586621679060841"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-226"></a><span class="hs-comment">-- ^ Symmetric choice.</span><span>
</span><a name="line-227"></a><a href="Text.ParserCombinators.ReadP.html#R"><span class="hs-identifier hs-var">R</span></a><span> </span><a name="local-6989586621679060855"><a href="#local-6989586621679060855"><span class="hs-identifier">f1</span></a></a><span> </span><a name="%2B%2B%2B"><a href="Text.ParserCombinators.ReadP.html#%2B%2B%2B"><span class="hs-operator">+++</span></a></a><span> </span><a href="Text.ParserCombinators.ReadP.html#R"><span class="hs-identifier hs-var">R</span></a><span> </span><a name="local-6989586621679060856"><a href="#local-6989586621679060856"><span class="hs-identifier">f2</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Text.ParserCombinators.ReadP.html#R"><span class="hs-identifier hs-var">R</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679060857"><a href="#local-6989586621679060857"><span class="hs-identifier">k</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679060855"><span class="hs-identifier hs-var">f1</span></a><span> </span><a href="#local-6989586621679060857"><span class="hs-identifier hs-var">k</span></a><span> </span><a href="GHC.Base.html#%3C%7C%3E"><span class="hs-operator hs-var">&lt;|&gt;</span></a><span> </span><a href="#local-6989586621679060856"><span class="hs-identifier hs-var">f2</span></a><span> </span><a href="#local-6989586621679060857"><span class="hs-identifier hs-var">k</span></a><span class="hs-special">)</span><span>
</span><a name="line-228"></a><span>
</span><a name="line-229"></a><span class="hs-special">(</span><span class="hs-operator">&lt;++</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Text.ParserCombinators.ReadP.html#ReadP"><span class="hs-identifier hs-type">ReadP</span></a><span> </span><a href="#local-6989586621679060840"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Text.ParserCombinators.ReadP.html#ReadP"><span class="hs-identifier hs-type">ReadP</span></a><span> </span><a href="#local-6989586621679060840"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Text.ParserCombinators.ReadP.html#ReadP"><span class="hs-identifier hs-type">ReadP</span></a><span> </span><a href="#local-6989586621679060840"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-230"></a><span class="hs-comment">-- ^ Local, exclusive, left-biased choice: If left parser</span><span>
</span><a name="line-231"></a><span class="hs-comment">--   locally produces any result at all, then right parser is</span><span>
</span><a name="line-232"></a><span class="hs-comment">--   not used.</span><span>
</span><a name="line-233"></a><a href="Text.ParserCombinators.ReadP.html#R"><span class="hs-identifier hs-var">R</span></a><span> </span><a name="local-6989586621679060858"><a href="#local-6989586621679060858"><span class="hs-identifier">f0</span></a></a><span> </span><a name="%3C%2B%2B"><a href="Text.ParserCombinators.ReadP.html#%3C%2B%2B"><span class="hs-operator">&lt;++</span></a></a><span> </span><a name="local-6989586621679060859"><a href="#local-6989586621679060859"><span class="hs-identifier">q</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-234"></a><span>  </span><span class="hs-keyword">do</span><span> </span><a name="local-6989586621679060873"><a href="#local-6989586621679060873"><span class="hs-identifier">s</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Text.ParserCombinators.ReadP.html#look"><span class="hs-identifier hs-var">look</span></a><span>
</span><a name="line-235"></a><span>     </span><a href="#local-6989586621679060860"><span class="hs-identifier hs-var">probe</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679060858"><span class="hs-identifier hs-var">f0</span></a><span> </span><a href="GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679060873"><span class="hs-identifier hs-var">s</span></a><span> </span><span class="hs-number">0</span><span class="hs-operator">#</span><span>
</span><a name="line-236"></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-237"></a><span>  </span><a name="local-6989586621679060860"><a href="#local-6989586621679060860"><span class="hs-identifier">probe</span></a></a><span> </span><span class="hs-special">(</span><a href="Text.ParserCombinators.ReadP.html#Get"><span class="hs-identifier hs-var">Get</span></a><span> </span><a name="local-6989586621679060862"><a href="#local-6989586621679060862"><span class="hs-identifier">f</span></a></a><span class="hs-special">)</span><span>        </span><span class="hs-special">(</span><a name="local-6989586621679060863"><a href="#local-6989586621679060863"><span class="hs-identifier">c</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679060864"><a href="#local-6989586621679060864"><span class="hs-identifier">s</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679060865"><a href="#local-6989586621679060865"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679060860"><span class="hs-identifier hs-var">probe</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679060862"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679060863"><span class="hs-identifier hs-var">c</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679060864"><span class="hs-identifier hs-var">s</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679060865"><span class="hs-identifier hs-var">n</span></a><a href="../ghc-prim-0.5.1.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Prim.html#%2B%23"><span class="hs-operator hs-var">+#</span></a><span class="hs-number">1</span><span class="hs-operator">#</span><span class="hs-special">)</span><span>
</span><a name="line-238"></a><span>  </span><span class="hs-identifier">probe</span><span> </span><span class="hs-special">(</span><a href="Text.ParserCombinators.ReadP.html#Look"><span class="hs-identifier hs-var">Look</span></a><span> </span><a name="local-6989586621679060866"><a href="#local-6989586621679060866"><span class="hs-identifier">f</span></a></a><span class="hs-special">)</span><span>       </span><a name="local-6989586621679060867"><a href="#local-6989586621679060867"><span class="hs-identifier">s</span></a></a><span>     </span><a name="local-6989586621679060868"><a href="#local-6989586621679060868"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679060860"><span class="hs-identifier hs-var">probe</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679060866"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679060867"><span class="hs-identifier hs-var">s</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679060867"><span class="hs-identifier hs-var">s</span></a><span> </span><a href="#local-6989586621679060868"><span class="hs-identifier hs-var">n</span></a><span>
</span><a name="line-239"></a><span>  </span><span class="hs-identifier">probe</span><span> </span><a name="local-6989586621679060869"><a href="#local-6989586621679060869"><span class="hs-identifier">p</span></a></a><span class="hs-glyph">@</span><span class="hs-special">(</span><a href="Text.ParserCombinators.ReadP.html#Result"><span class="hs-identifier hs-var">Result</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-identifier">_</span><span>     </span><a name="local-6989586621679060870"><a href="#local-6989586621679060870"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679060861"><span class="hs-identifier hs-var">discard</span></a><span> </span><a href="#local-6989586621679060870"><span class="hs-identifier hs-var">n</span></a><span> </span><a href="GHC.Base.html#%3E%3E"><span class="hs-operator hs-var">&gt;&gt;</span></a><span> </span><a href="Text.ParserCombinators.ReadP.html#R"><span class="hs-identifier hs-var">R</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679060869"><span class="hs-identifier hs-var">p</span></a><span> </span><a href="GHC.Base.html#%3E%3E%3D"><span class="hs-operator hs-var">&gt;&gt;=</span></a><span class="hs-special">)</span><span>
</span><a name="line-240"></a><span>  </span><span class="hs-identifier">probe</span><span> </span><span class="hs-special">(</span><a href="Text.ParserCombinators.ReadP.html#Final"><span class="hs-identifier hs-var">Final</span></a><span> </span><a name="local-6989586621679060871"><a href="#local-6989586621679060871"><span class="hs-identifier">r</span></a></a><span class="hs-special">)</span><span>      </span><span class="hs-identifier">_</span><span>     </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Text.ParserCombinators.ReadP.html#R"><span class="hs-identifier hs-var">R</span></a><span> </span><span class="hs-special">(</span><a href="Text.ParserCombinators.ReadP.html#Final"><span class="hs-identifier hs-var">Final</span></a><span> </span><a href="#local-6989586621679060871"><span class="hs-identifier hs-var">r</span></a><span> </span><a href="GHC.Base.html#%3E%3E%3D"><span class="hs-operator hs-var">&gt;&gt;=</span></a><span class="hs-special">)</span><span>
</span><a name="line-241"></a><span>  </span><span class="hs-identifier">probe</span><span> </span><span class="hs-identifier">_</span><span>              </span><span class="hs-identifier">_</span><span>     </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679060859"><span class="hs-identifier hs-var">q</span></a><span>
</span><a name="line-242"></a><span>
</span><a name="line-243"></a><span>  </span><a name="local-6989586621679060861"><a href="#local-6989586621679060861"><span class="hs-identifier">discard</span></a></a><span> </span><span class="hs-number">0</span><span class="hs-operator">#</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-244"></a><span>  </span><span class="hs-identifier">discard</span><span> </span><a name="local-6989586621679060872"><a href="#local-6989586621679060872"><span class="hs-identifier">n</span></a></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Text.ParserCombinators.ReadP.html#get"><span class="hs-identifier hs-var">get</span></a><span> </span><a href="GHC.Base.html#%3E%3E"><span class="hs-operator hs-var">&gt;&gt;</span></a><span> </span><a href="#local-6989586621679060861"><span class="hs-identifier hs-var">discard</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679060872"><span class="hs-identifier hs-var">n</span></a><a href="../ghc-prim-0.5.1.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Prim.html#-%23"><span class="hs-operator hs-var">-#</span></a><span class="hs-number">1</span><span class="hs-operator">#</span><span class="hs-special">)</span><span>
</span><a name="line-245"></a><span>
</span><a name="line-246"></a><span class="hs-identifier">gather</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Text.ParserCombinators.ReadP.html#ReadP"><span class="hs-identifier hs-type">ReadP</span></a><span> </span><a href="#local-6989586621679060839"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Text.ParserCombinators.ReadP.html#ReadP"><span class="hs-identifier hs-type">ReadP</span></a><span> </span><span class="hs-special">(</span><a href="GHC.Base.html#String"><span class="hs-identifier hs-type">String</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679060839"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-247"></a><span class="hs-comment">-- ^ Transforms a parser into one that does the same, but</span><span>
</span><a name="line-248"></a><span class="hs-comment">--   in addition returns the exact characters read.</span><span>
</span><a name="line-249"></a><span class="hs-comment">--   IMPORTANT NOTE: 'gather' gives a runtime error if its first argument</span><span>
</span><a name="line-250"></a><span class="hs-comment">--   is built using any occurrences of readS_to_P.</span><span>
</span><a name="line-251"></a><a name="gather"><a href="Text.ParserCombinators.ReadP.html#gather"><span class="hs-identifier">gather</span></a></a><span> </span><span class="hs-special">(</span><a href="Text.ParserCombinators.ReadP.html#R"><span class="hs-identifier hs-var">R</span></a><span> </span><a name="local-6989586621679060874"><a href="#local-6989586621679060874"><span class="hs-identifier">m</span></a></a><span class="hs-special">)</span><span>
</span><a name="line-252"></a><span>  </span><span class="hs-glyph">=</span><span> </span><a href="Text.ParserCombinators.ReadP.html#R"><span class="hs-identifier hs-var">R</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679060886"><a href="#local-6989586621679060886"><span class="hs-identifier">k</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679060875"><span class="hs-identifier hs-var">gath</span></a><span> </span><a href="GHC.Base.html#id"><span class="hs-identifier hs-var">id</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679060874"><span class="hs-identifier hs-var">m</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679060887"><a href="#local-6989586621679060887"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679060888"><a href="#local-6989586621679060888"><span class="hs-identifier">s</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679060886"><span class="hs-identifier hs-var">k</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679060888"><span class="hs-identifier hs-var">s</span></a><span class="hs-special">,</span><a href="#local-6989586621679060887"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-253"></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-254"></a><span>  </span><span class="hs-identifier">gath</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="GHC.Base.html#String"><span class="hs-identifier hs-type">String</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="GHC.Base.html#String"><span class="hs-identifier hs-type">String</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Text.ParserCombinators.ReadP.html#P"><span class="hs-identifier hs-type">P</span></a><span> </span><span class="hs-special">(</span><a href="GHC.Base.html#String"><span class="hs-identifier hs-type">String</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Text.ParserCombinators.ReadP.html#P"><span class="hs-identifier hs-type">P</span></a><span> </span><a href="#local-6989586621679060876"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Text.ParserCombinators.ReadP.html#P"><span class="hs-identifier hs-type">P</span></a><span> </span><a href="#local-6989586621679060876"><span class="hs-identifier hs-type">b</span></a><span>
</span><a name="line-255"></a><span>  </span><a name="local-6989586621679060875"><a href="#local-6989586621679060875"><span class="hs-identifier">gath</span></a></a><span> </span><a name="local-6989586621679060877"><a href="#local-6989586621679060877"><span class="hs-identifier">l</span></a></a><span> </span><span class="hs-special">(</span><a href="Text.ParserCombinators.ReadP.html#Get"><span class="hs-identifier hs-var">Get</span></a><span> </span><a name="local-6989586621679060878"><a href="#local-6989586621679060878"><span class="hs-identifier">f</span></a></a><span class="hs-special">)</span><span>      </span><span class="hs-glyph">=</span><span> </span><a href="Text.ParserCombinators.ReadP.html#Get"><span class="hs-identifier hs-var">Get</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679060879"><a href="#local-6989586621679060879"><span class="hs-identifier">c</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679060875"><span class="hs-identifier hs-var">gath</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679060877"><span class="hs-identifier hs-var">l</span></a><a href="GHC.Base.html#."><span class="hs-operator hs-var">.</span></a><span class="hs-special">(</span><a href="#local-6989586621679060879"><span class="hs-identifier hs-var">c</span></a><span class="hs-glyph">:</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679060878"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679060879"><span class="hs-identifier hs-var">c</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-256"></a><span>  </span><span class="hs-identifier">gath</span><span> </span><span class="hs-identifier">_</span><span> </span><a href="Text.ParserCombinators.ReadP.html#Fail"><span class="hs-identifier hs-var">Fail</span></a><span>         </span><span class="hs-glyph">=</span><span> </span><a href="Text.ParserCombinators.ReadP.html#Fail"><span class="hs-identifier hs-var">Fail</span></a><span>
</span><a name="line-257"></a><span>  </span><span class="hs-identifier">gath</span><span> </span><a name="local-6989586621679060880"><a href="#local-6989586621679060880"><span class="hs-identifier">l</span></a></a><span> </span><span class="hs-special">(</span><a href="Text.ParserCombinators.ReadP.html#Look"><span class="hs-identifier hs-var">Look</span></a><span> </span><a name="local-6989586621679060881"><a href="#local-6989586621679060881"><span class="hs-identifier">f</span></a></a><span class="hs-special">)</span><span>     </span><span class="hs-glyph">=</span><span> </span><a href="Text.ParserCombinators.ReadP.html#Look"><span class="hs-identifier hs-var">Look</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679060882"><a href="#local-6989586621679060882"><span class="hs-identifier">s</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679060875"><span class="hs-identifier hs-var">gath</span></a><span> </span><a href="#local-6989586621679060880"><span class="hs-identifier hs-var">l</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679060881"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679060882"><span class="hs-identifier hs-var">s</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-258"></a><span>  </span><span class="hs-identifier">gath</span><span> </span><a name="local-6989586621679060883"><a href="#local-6989586621679060883"><span class="hs-identifier">l</span></a></a><span> </span><span class="hs-special">(</span><a href="Text.ParserCombinators.ReadP.html#Result"><span class="hs-identifier hs-var">Result</span></a><span> </span><a name="local-6989586621679060884"><a href="#local-6989586621679060884"><span class="hs-identifier">k</span></a></a><span> </span><a name="local-6989586621679060885"><a href="#local-6989586621679060885"><span class="hs-identifier">p</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679060884"><span class="hs-identifier hs-var">k</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679060883"><span class="hs-identifier hs-var">l</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><a href="GHC.Base.html#%3C%7C%3E"><span class="hs-operator hs-var">&lt;|&gt;</span></a><span> </span><a href="#local-6989586621679060875"><span class="hs-identifier hs-var">gath</span></a><span> </span><a href="#local-6989586621679060883"><span class="hs-identifier hs-var">l</span></a><span> </span><a href="#local-6989586621679060885"><span class="hs-identifier hs-var">p</span></a><span>
</span><a name="line-259"></a><span>  </span><span class="hs-identifier">gath</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><a href="Text.ParserCombinators.ReadP.html#Final"><span class="hs-identifier hs-var">Final</span></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>    </span><span class="hs-glyph">=</span><span> </span><a href="GHC.Err.html#errorWithoutStackTrace"><span class="hs-identifier hs-var">errorWithoutStackTrace</span></a><span> </span><span class="hs-string">&quot;do not use readS_to_P in gather!&quot;</span><span>
</span><a name="line-260"></a><span>
</span><a name="line-261"></a><span class="hs-comment">-- ---------------------------------------------------------------------------</span><span>
</span><a name="line-262"></a><span class="hs-comment">-- Derived operations</span><span>
</span><a name="line-263"></a><span>
</span><a name="line-264"></a><span class="hs-identifier">satisfy</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="../ghc-prim-0.5.1.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Types.html#Char"><span class="hs-identifier hs-type">Char</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../ghc-prim-0.5.1.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Types.html#Bool"><span class="hs-identifier hs-type">Bool</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Text.ParserCombinators.ReadP.html#ReadP"><span class="hs-identifier hs-type">ReadP</span></a><span> </span><a href="../ghc-prim-0.5.1.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Types.html#Char"><span class="hs-identifier hs-type">Char</span></a><span>
</span><a name="line-265"></a><span class="hs-comment">-- ^ Consumes and returns the next character, if it satisfies the</span><span>
</span><a name="line-266"></a><span class="hs-comment">--   specified predicate.</span><span>
</span><a name="line-267"></a><a name="satisfy"><a href="Text.ParserCombinators.ReadP.html#satisfy"><span class="hs-identifier">satisfy</span></a></a><span> </span><a name="local-6989586621679060889"><a href="#local-6989586621679060889"><span class="hs-identifier">p</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><a name="local-6989586621679060890"><a href="#local-6989586621679060890"><span class="hs-identifier">c</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Text.ParserCombinators.ReadP.html#get"><span class="hs-identifier hs-var">get</span></a><span class="hs-special">;</span><span> </span><span class="hs-keyword">if</span><span> </span><a href="#local-6989586621679060889"><span class="hs-identifier hs-var">p</span></a><span> </span><a href="#local-6989586621679060890"><span class="hs-identifier hs-var">c</span></a><span> </span><span class="hs-keyword">then</span><span> </span><a href="GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><a href="#local-6989586621679060890"><span class="hs-identifier hs-var">c</span></a><span> </span><span class="hs-keyword">else</span><span> </span><a href="Text.ParserCombinators.ReadP.html#pfail"><span class="hs-identifier hs-var">pfail</span></a><span>
</span><a name="line-268"></a><span>
</span><a name="line-269"></a><span class="hs-identifier">char</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="../ghc-prim-0.5.1.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Types.html#Char"><span class="hs-identifier hs-type">Char</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Text.ParserCombinators.ReadP.html#ReadP"><span class="hs-identifier hs-type">ReadP</span></a><span> </span><a href="../ghc-prim-0.5.1.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Types.html#Char"><span class="hs-identifier hs-type">Char</span></a><span>
</span><a name="line-270"></a><span class="hs-comment">-- ^ Parses and returns the specified character.</span><span>
</span><a name="line-271"></a><a name="char"><a href="Text.ParserCombinators.ReadP.html#char"><span class="hs-identifier">char</span></a></a><span> </span><a name="local-6989586621679060891"><a href="#local-6989586621679060891"><span class="hs-identifier">c</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Text.ParserCombinators.ReadP.html#satisfy"><span class="hs-identifier hs-var">satisfy</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679060891"><span class="hs-identifier hs-var">c</span></a><span> </span><a href="../ghc-prim-0.5.1.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Classes.html#%3D%3D"><span class="hs-operator hs-var">==</span></a><span class="hs-special">)</span><span>
</span><a name="line-272"></a><span>
</span><a name="line-273"></a><span class="hs-identifier">eof</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Text.ParserCombinators.ReadP.html#ReadP"><span class="hs-identifier hs-type">ReadP</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-274"></a><span class="hs-comment">-- ^ Succeeds iff we are at the end of input</span><span>
</span><a name="line-275"></a><a name="eof"><a href="Text.ParserCombinators.ReadP.html#eof"><span class="hs-identifier">eof</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span> </span><a name="local-6989586621679060892"><a href="#local-6989586621679060892"><span class="hs-identifier">s</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Text.ParserCombinators.ReadP.html#look"><span class="hs-identifier hs-var">look</span></a><span>
</span><a name="line-276"></a><span>         </span><span class="hs-special">;</span><span> </span><span class="hs-keyword">if</span><span> </span><a href="GHC.List.html#null"><span class="hs-identifier hs-var">null</span></a><span> </span><a href="#local-6989586621679060892"><span class="hs-identifier hs-var">s</span></a><span> </span><span class="hs-keyword">then</span><span> </span><a href="GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-277"></a><span>                     </span><span class="hs-keyword">else</span><span> </span><a href="Text.ParserCombinators.ReadP.html#pfail"><span class="hs-identifier hs-var">pfail</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-278"></a><span>
</span><a name="line-279"></a><span class="hs-identifier">string</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="GHC.Base.html#String"><span class="hs-identifier hs-type">String</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Text.ParserCombinators.ReadP.html#ReadP"><span class="hs-identifier hs-type">ReadP</span></a><span> </span><a href="GHC.Base.html#String"><span class="hs-identifier hs-type">String</span></a><span>
</span><a name="line-280"></a><span class="hs-comment">-- ^ Parses and returns the specified string.</span><span>
</span><a name="line-281"></a><a name="string"><a href="Text.ParserCombinators.ReadP.html#string"><span class="hs-identifier">string</span></a></a><span> </span><a name="local-6989586621679060893"><a href="#local-6989586621679060893"><span class="hs-identifier">this</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><a name="local-6989586621679060899"><a href="#local-6989586621679060899"><span class="hs-identifier">s</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Text.ParserCombinators.ReadP.html#look"><span class="hs-identifier hs-var">look</span></a><span class="hs-special">;</span><span> </span><a href="#local-6989586621679060894"><span class="hs-identifier hs-var">scan</span></a><span> </span><a href="#local-6989586621679060893"><span class="hs-identifier hs-var">this</span></a><span> </span><a href="#local-6989586621679060899"><span class="hs-identifier hs-var">s</span></a><span>
</span><a name="line-282"></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-283"></a><span>  </span><a name="local-6989586621679060894"><a href="#local-6989586621679060894"><span class="hs-identifier">scan</span></a></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>     </span><span class="hs-identifier">_</span><span>               </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><a href="GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><a href="#local-6989586621679060893"><span class="hs-identifier hs-var">this</span></a><span>
</span><a name="line-284"></a><span>  </span><span class="hs-identifier">scan</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679060895"><a href="#local-6989586621679060895"><span class="hs-identifier">x</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679060896"><a href="#local-6989586621679060896"><span class="hs-identifier">xs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679060897"><a href="#local-6989586621679060897"><span class="hs-identifier">y</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679060898"><a href="#local-6989586621679060898"><span class="hs-identifier">ys</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679060895"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="../ghc-prim-0.5.1.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Classes.html#%3D%3D"><span class="hs-operator hs-var">==</span></a><span> </span><a href="#local-6989586621679060897"><span class="hs-identifier hs-var">y</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Text.ParserCombinators.ReadP.html#get"><span class="hs-identifier hs-var">get</span></a><span class="hs-special">;</span><span> </span><a href="#local-6989586621679060894"><span class="hs-identifier hs-var">scan</span></a><span> </span><a href="#local-6989586621679060896"><span class="hs-identifier hs-var">xs</span></a><span> </span><a href="#local-6989586621679060898"><span class="hs-identifier hs-var">ys</span></a><span>
</span><a name="line-285"></a><span>  </span><span class="hs-identifier">scan</span><span> </span><span class="hs-identifier">_</span><span>      </span><span class="hs-identifier">_</span><span>               </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><a href="Text.ParserCombinators.ReadP.html#pfail"><span class="hs-identifier hs-var">pfail</span></a><span>
</span><a name="line-286"></a><span>
</span><a name="line-287"></a><span class="hs-identifier">munch</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="../ghc-prim-0.5.1.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Types.html#Char"><span class="hs-identifier hs-type">Char</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../ghc-prim-0.5.1.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Types.html#Bool"><span class="hs-identifier hs-type">Bool</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Text.ParserCombinators.ReadP.html#ReadP"><span class="hs-identifier hs-type">ReadP</span></a><span> </span><a href="GHC.Base.html#String"><span class="hs-identifier hs-type">String</span></a><span>
</span><a name="line-288"></a><span class="hs-comment">-- ^ Parses the first zero or more characters satisfying the predicate.</span><span>
</span><a name="line-289"></a><span class="hs-comment">--   Always succeds, exactly once having consumed all the characters</span><span>
</span><a name="line-290"></a><span class="hs-comment">--   Hence NOT the same as (many (satisfy p))</span><span>
</span><a name="line-291"></a><a name="munch"><a href="Text.ParserCombinators.ReadP.html#munch"><span class="hs-identifier">munch</span></a></a><span> </span><a name="local-6989586621679060900"><a href="#local-6989586621679060900"><span class="hs-identifier">p</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-292"></a><span>  </span><span class="hs-keyword">do</span><span> </span><a name="local-6989586621679060905"><a href="#local-6989586621679060905"><span class="hs-identifier">s</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Text.ParserCombinators.ReadP.html#look"><span class="hs-identifier hs-var">look</span></a><span>
</span><a name="line-293"></a><span>     </span><a href="#local-6989586621679060901"><span class="hs-identifier hs-var">scan</span></a><span> </span><a href="#local-6989586621679060905"><span class="hs-identifier hs-var">s</span></a><span>
</span><a name="line-294"></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-295"></a><span>  </span><a name="local-6989586621679060901"><a href="#local-6989586621679060901"><span class="hs-identifier">scan</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679060902"><a href="#local-6989586621679060902"><span class="hs-identifier">c</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679060903"><a href="#local-6989586621679060903"><span class="hs-identifier">cs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><a href="#local-6989586621679060900"><span class="hs-identifier hs-var">p</span></a><span> </span><a href="#local-6989586621679060902"><span class="hs-identifier hs-var">c</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Text.ParserCombinators.ReadP.html#get"><span class="hs-identifier hs-var">get</span></a><span class="hs-special">;</span><span> </span><a name="local-6989586621679060904"><a href="#local-6989586621679060904"><span class="hs-identifier">s</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679060901"><span class="hs-identifier hs-var">scan</span></a><span> </span><a href="#local-6989586621679060903"><span class="hs-identifier hs-var">cs</span></a><span class="hs-special">;</span><span> </span><a href="GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679060902"><span class="hs-identifier hs-var">c</span></a><span class="hs-glyph">:</span><a href="#local-6989586621679060904"><span class="hs-identifier hs-var">s</span></a><span class="hs-special">)</span><span>
</span><a name="line-296"></a><span>  </span><span class="hs-identifier">scan</span><span> </span><span class="hs-identifier">_</span><span>            </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><a href="GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-string">&quot;&quot;</span><span>
</span><a name="line-297"></a><span>
</span><a name="line-298"></a><span class="hs-identifier">munch1</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="../ghc-prim-0.5.1.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Types.html#Char"><span class="hs-identifier hs-type">Char</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="../ghc-prim-0.5.1.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Types.html#Bool"><span class="hs-identifier hs-type">Bool</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Text.ParserCombinators.ReadP.html#ReadP"><span class="hs-identifier hs-type">ReadP</span></a><span> </span><a href="GHC.Base.html#String"><span class="hs-identifier hs-type">String</span></a><span>
</span><a name="line-299"></a><span class="hs-comment">-- ^ Parses the first one or more characters satisfying the predicate.</span><span>
</span><a name="line-300"></a><span class="hs-comment">--   Fails if none, else succeeds exactly once having consumed all the characters</span><span>
</span><a name="line-301"></a><span class="hs-comment">--   Hence NOT the same as (many1 (satisfy p))</span><span>
</span><a name="line-302"></a><a name="munch1"><a href="Text.ParserCombinators.ReadP.html#munch1"><span class="hs-identifier">munch1</span></a></a><span> </span><a name="local-6989586621679060906"><a href="#local-6989586621679060906"><span class="hs-identifier">p</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-303"></a><span>  </span><span class="hs-keyword">do</span><span> </span><a name="local-6989586621679060907"><a href="#local-6989586621679060907"><span class="hs-identifier">c</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Text.ParserCombinators.ReadP.html#get"><span class="hs-identifier hs-var">get</span></a><span>
</span><a name="line-304"></a><span>     </span><span class="hs-keyword">if</span><span> </span><a href="#local-6989586621679060906"><span class="hs-identifier hs-var">p</span></a><span> </span><a href="#local-6989586621679060907"><span class="hs-identifier hs-var">c</span></a><span> </span><span class="hs-keyword">then</span><span> </span><span class="hs-keyword">do</span><span> </span><a name="local-6989586621679060908"><a href="#local-6989586621679060908"><span class="hs-identifier">s</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Text.ParserCombinators.ReadP.html#munch"><span class="hs-identifier hs-var">munch</span></a><span> </span><a href="#local-6989586621679060906"><span class="hs-identifier hs-var">p</span></a><span class="hs-special">;</span><span> </span><a href="GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679060907"><span class="hs-identifier hs-var">c</span></a><span class="hs-glyph">:</span><a href="#local-6989586621679060908"><span class="hs-identifier hs-var">s</span></a><span class="hs-special">)</span><span>
</span><a name="line-305"></a><span>            </span><span class="hs-keyword">else</span><span> </span><a href="Text.ParserCombinators.ReadP.html#pfail"><span class="hs-identifier hs-var">pfail</span></a><span>
</span><a name="line-306"></a><span>
</span><a name="line-307"></a><span class="hs-identifier">choice</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="Text.ParserCombinators.ReadP.html#ReadP"><span class="hs-identifier hs-type">ReadP</span></a><span> </span><a href="#local-6989586621679060838"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Text.ParserCombinators.ReadP.html#ReadP"><span class="hs-identifier hs-type">ReadP</span></a><span> </span><a href="#local-6989586621679060838"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-308"></a><span class="hs-comment">-- ^ Combines all parsers in the specified list.</span><span>
</span><a name="line-309"></a><a name="choice"><a href="Text.ParserCombinators.ReadP.html#choice"><span class="hs-identifier">choice</span></a></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>     </span><span class="hs-glyph">=</span><span> </span><a href="Text.ParserCombinators.ReadP.html#pfail"><span class="hs-identifier hs-var">pfail</span></a><span>
</span><a name="line-310"></a><span class="hs-identifier">choice</span><span> </span><span class="hs-special">[</span><a name="local-6989586621679060909"><a href="#local-6989586621679060909"><span class="hs-identifier">p</span></a></a><span class="hs-special">]</span><span>    </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679060909"><span class="hs-identifier hs-var">p</span></a><span>
</span><a name="line-311"></a><span class="hs-identifier">choice</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679060910"><a href="#local-6989586621679060910"><span class="hs-identifier">p</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679060911"><a href="#local-6989586621679060911"><span class="hs-identifier">ps</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679060910"><span class="hs-identifier hs-var">p</span></a><span> </span><a href="Text.ParserCombinators.ReadP.html#%2B%2B%2B"><span class="hs-operator hs-var">+++</span></a><span> </span><a href="Text.ParserCombinators.ReadP.html#choice"><span class="hs-identifier hs-var">choice</span></a><span> </span><a href="#local-6989586621679060911"><span class="hs-identifier hs-var">ps</span></a><span>
</span><a name="line-312"></a><span>
</span><a name="line-313"></a><span class="hs-identifier">skipSpaces</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Text.ParserCombinators.ReadP.html#ReadP"><span class="hs-identifier hs-type">ReadP</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-314"></a><span class="hs-comment">-- ^ Skips all whitespace.</span><span>
</span><a name="line-315"></a><a name="skipSpaces"><a href="Text.ParserCombinators.ReadP.html#skipSpaces"><span class="hs-identifier">skipSpaces</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-316"></a><span>  </span><span class="hs-keyword">do</span><span> </span><a name="local-6989586621679060915"><a href="#local-6989586621679060915"><span class="hs-identifier">s</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Text.ParserCombinators.ReadP.html#look"><span class="hs-identifier hs-var">look</span></a><span>
</span><a name="line-317"></a><span>     </span><a href="#local-6989586621679060912"><span class="hs-identifier hs-var">skip</span></a><span> </span><a href="#local-6989586621679060915"><span class="hs-identifier hs-var">s</span></a><span>
</span><a name="line-318"></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-319"></a><span>  </span><a name="local-6989586621679060912"><a href="#local-6989586621679060912"><span class="hs-identifier">skip</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679060913"><a href="#local-6989586621679060913"><span class="hs-identifier">c</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679060914"><a href="#local-6989586621679060914"><span class="hs-identifier">s</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">|</span><span> </span><a href="GHC.Unicode.html#isSpace"><span class="hs-identifier hs-var">isSpace</span></a><span> </span><a href="#local-6989586621679060913"><span class="hs-identifier hs-var">c</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Text.ParserCombinators.ReadP.html#get"><span class="hs-identifier hs-var">get</span></a><span class="hs-special">;</span><span> </span><a href="#local-6989586621679060912"><span class="hs-identifier hs-var">skip</span></a><span> </span><a href="#local-6989586621679060914"><span class="hs-identifier hs-var">s</span></a><span>
</span><a name="line-320"></a><span>  </span><span class="hs-identifier">skip</span><span> </span><span class="hs-identifier">_</span><span>                 </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><a href="GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-321"></a><span>
</span><a name="line-322"></a><span class="hs-identifier">count</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="../ghc-prim-0.5.1.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Types.html#Int"><span class="hs-identifier hs-type">Int</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Text.ParserCombinators.ReadP.html#ReadP"><span class="hs-identifier hs-type">ReadP</span></a><span> </span><a href="#local-6989586621679060837"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Text.ParserCombinators.ReadP.html#ReadP"><span class="hs-identifier hs-type">ReadP</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621679060837"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span>
</span><a name="line-323"></a><span class="hs-comment">-- ^ @count n p@ parses @n@ occurrences of @p@ in sequence. A list of</span><span>
</span><a name="line-324"></a><span class="hs-comment">--   results is returned.</span><span>
</span><a name="line-325"></a><a name="count"><a href="Text.ParserCombinators.ReadP.html#count"><span class="hs-identifier">count</span></a></a><span> </span><a name="local-6989586621679060916"><a href="#local-6989586621679060916"><span class="hs-identifier">n</span></a></a><span> </span><a name="local-6989586621679060917"><a href="#local-6989586621679060917"><span class="hs-identifier">p</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="GHC.Base.html#sequence"><span class="hs-identifier hs-var">sequence</span></a><span> </span><span class="hs-special">(</span><a href="GHC.List.html#replicate"><span class="hs-identifier hs-var">replicate</span></a><span> </span><a href="#local-6989586621679060916"><span class="hs-identifier hs-var">n</span></a><span> </span><a href="#local-6989586621679060917"><span class="hs-identifier hs-var">p</span></a><span class="hs-special">)</span><span>
</span><a name="line-326"></a><span>
</span><a name="line-327"></a><span class="hs-identifier">between</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Text.ParserCombinators.ReadP.html#ReadP"><span class="hs-identifier hs-type">ReadP</span></a><span> </span><a href="#local-6989586621679060834"><span class="hs-identifier hs-type">open</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Text.ParserCombinators.ReadP.html#ReadP"><span class="hs-identifier hs-type">ReadP</span></a><span> </span><a href="#local-6989586621679060835"><span class="hs-identifier hs-type">close</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Text.ParserCombinators.ReadP.html#ReadP"><span class="hs-identifier hs-type">ReadP</span></a><span> </span><a href="#local-6989586621679060836"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Text.ParserCombinators.ReadP.html#ReadP"><span class="hs-identifier hs-type">ReadP</span></a><span> </span><a href="#local-6989586621679060836"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-328"></a><span class="hs-comment">-- ^ @between open close p@ parses @open@, followed by @p@ and finally</span><span>
</span><a name="line-329"></a><span class="hs-comment">--   @close@. Only the value of @p@ is returned.</span><span>
</span><a name="line-330"></a><a name="between"><a href="Text.ParserCombinators.ReadP.html#between"><span class="hs-identifier">between</span></a></a><span> </span><a name="local-6989586621679060918"><a href="#local-6989586621679060918"><span class="hs-identifier">open</span></a></a><span> </span><a name="local-6989586621679060919"><a href="#local-6989586621679060919"><span class="hs-identifier">close</span></a></a><span> </span><a name="local-6989586621679060920"><a href="#local-6989586621679060920"><span class="hs-identifier">p</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679060918"><span class="hs-identifier hs-var">open</span></a><span>
</span><a name="line-331"></a><span>                          </span><a name="local-6989586621679060921"><a href="#local-6989586621679060921"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679060920"><span class="hs-identifier hs-var">p</span></a><span>
</span><a name="line-332"></a><span>                          </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679060919"><span class="hs-identifier hs-var">close</span></a><span>
</span><a name="line-333"></a><span>                          </span><a href="GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><a href="#local-6989586621679060921"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-334"></a><span>
</span><a name="line-335"></a><span class="hs-identifier">option</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="#local-6989586621679060833"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Text.ParserCombinators.ReadP.html#ReadP"><span class="hs-identifier hs-type">ReadP</span></a><span> </span><a href="#local-6989586621679060833"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Text.ParserCombinators.ReadP.html#ReadP"><span class="hs-identifier hs-type">ReadP</span></a><span> </span><a href="#local-6989586621679060833"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-336"></a><span class="hs-comment">-- ^ @option x p@ will either parse @p@ or return @x@ without consuming</span><span>
</span><a name="line-337"></a><span class="hs-comment">--   any input.</span><span>
</span><a name="line-338"></a><a name="option"><a href="Text.ParserCombinators.ReadP.html#option"><span class="hs-identifier">option</span></a></a><span> </span><a name="local-6989586621679060922"><a href="#local-6989586621679060922"><span class="hs-identifier">x</span></a></a><span> </span><a name="local-6989586621679060923"><a href="#local-6989586621679060923"><span class="hs-identifier">p</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679060923"><span class="hs-identifier hs-var">p</span></a><span> </span><a href="Text.ParserCombinators.ReadP.html#%2B%2B%2B"><span class="hs-operator hs-var">+++</span></a><span> </span><a href="GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><a href="#local-6989586621679060922"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-339"></a><span>
</span><a name="line-340"></a><span class="hs-identifier">optional</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Text.ParserCombinators.ReadP.html#ReadP"><span class="hs-identifier hs-type">ReadP</span></a><span> </span><a href="#local-6989586621679060832"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Text.ParserCombinators.ReadP.html#ReadP"><span class="hs-identifier hs-type">ReadP</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-341"></a><span class="hs-comment">-- ^ @optional p@ optionally parses @p@ and always returns @()@.</span><span>
</span><a name="line-342"></a><a name="optional"><a href="Text.ParserCombinators.ReadP.html#optional"><span class="hs-identifier">optional</span></a></a><span> </span><a name="local-6989586621679060924"><a href="#local-6989586621679060924"><span class="hs-identifier">p</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679060924"><span class="hs-identifier hs-var">p</span></a><span> </span><a href="GHC.Base.html#%3E%3E"><span class="hs-operator hs-var">&gt;&gt;</span></a><span> </span><a href="GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a href="Text.ParserCombinators.ReadP.html#%2B%2B%2B"><span class="hs-operator hs-var">+++</span></a><span> </span><a href="GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-343"></a><span>
</span><a name="line-344"></a><span class="hs-identifier">many</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Text.ParserCombinators.ReadP.html#ReadP"><span class="hs-identifier hs-type">ReadP</span></a><span> </span><a href="#local-6989586621679060831"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Text.ParserCombinators.ReadP.html#ReadP"><span class="hs-identifier hs-type">ReadP</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621679060831"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span>
</span><a name="line-345"></a><span class="hs-comment">-- ^ Parses zero or more occurrences of the given parser.</span><span>
</span><a name="line-346"></a><a name="many"><a href="Text.ParserCombinators.ReadP.html#many"><span class="hs-identifier">many</span></a></a><span> </span><a name="local-6989586621679060925"><a href="#local-6989586621679060925"><span class="hs-identifier">p</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><a href="Text.ParserCombinators.ReadP.html#%2B%2B%2B"><span class="hs-operator hs-var">+++</span></a><span> </span><a href="Text.ParserCombinators.ReadP.html#many1"><span class="hs-identifier hs-var">many1</span></a><span> </span><a href="#local-6989586621679060925"><span class="hs-identifier hs-var">p</span></a><span>
</span><a name="line-347"></a><span>
</span><a name="line-348"></a><span class="hs-identifier">many1</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Text.ParserCombinators.ReadP.html#ReadP"><span class="hs-identifier hs-type">ReadP</span></a><span> </span><a href="#local-6989586621679060830"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Text.ParserCombinators.ReadP.html#ReadP"><span class="hs-identifier hs-type">ReadP</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621679060830"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span>
</span><a name="line-349"></a><span class="hs-comment">-- ^ Parses one or more occurrences of the given parser.</span><span>
</span><a name="line-350"></a><a name="many1"><a href="Text.ParserCombinators.ReadP.html#many1"><span class="hs-identifier">many1</span></a></a><span> </span><a name="local-6989586621679060926"><a href="#local-6989586621679060926"><span class="hs-identifier">p</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="GHC.Base.html#liftM2"><span class="hs-identifier hs-var">liftM2</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">:</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679060926"><span class="hs-identifier hs-var">p</span></a><span> </span><span class="hs-special">(</span><a href="Text.ParserCombinators.ReadP.html#many"><span class="hs-identifier hs-var">many</span></a><span> </span><a href="#local-6989586621679060926"><span class="hs-identifier hs-var">p</span></a><span class="hs-special">)</span><span>
</span><a name="line-351"></a><span>
</span><a name="line-352"></a><span class="hs-identifier">skipMany</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Text.ParserCombinators.ReadP.html#ReadP"><span class="hs-identifier hs-type">ReadP</span></a><span> </span><a href="#local-6989586621679060829"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Text.ParserCombinators.ReadP.html#ReadP"><span class="hs-identifier hs-type">ReadP</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-353"></a><span class="hs-comment">-- ^ Like 'many', but discards the result.</span><span>
</span><a name="line-354"></a><a name="skipMany"><a href="Text.ParserCombinators.ReadP.html#skipMany"><span class="hs-identifier">skipMany</span></a></a><span> </span><a name="local-6989586621679060927"><a href="#local-6989586621679060927"><span class="hs-identifier">p</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Text.ParserCombinators.ReadP.html#many"><span class="hs-identifier hs-var">many</span></a><span> </span><a href="#local-6989586621679060927"><span class="hs-identifier hs-var">p</span></a><span> </span><a href="GHC.Base.html#%3E%3E"><span class="hs-operator hs-var">&gt;&gt;</span></a><span> </span><a href="GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-355"></a><span>
</span><a name="line-356"></a><span class="hs-identifier">skipMany1</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Text.ParserCombinators.ReadP.html#ReadP"><span class="hs-identifier hs-type">ReadP</span></a><span> </span><a href="#local-6989586621679060828"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Text.ParserCombinators.ReadP.html#ReadP"><span class="hs-identifier hs-type">ReadP</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-357"></a><span class="hs-comment">-- ^ Like 'many1', but discards the result.</span><span>
</span><a name="line-358"></a><a name="skipMany1"><a href="Text.ParserCombinators.ReadP.html#skipMany1"><span class="hs-identifier">skipMany1</span></a></a><span> </span><a name="local-6989586621679060928"><a href="#local-6989586621679060928"><span class="hs-identifier">p</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679060928"><span class="hs-identifier hs-var">p</span></a><span> </span><a href="GHC.Base.html#%3E%3E"><span class="hs-operator hs-var">&gt;&gt;</span></a><span> </span><a href="Text.ParserCombinators.ReadP.html#skipMany"><span class="hs-identifier hs-var">skipMany</span></a><span> </span><a href="#local-6989586621679060928"><span class="hs-identifier hs-var">p</span></a><span>
</span><a name="line-359"></a><span>
</span><a name="line-360"></a><span class="hs-identifier">sepBy</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Text.ParserCombinators.ReadP.html#ReadP"><span class="hs-identifier hs-type">ReadP</span></a><span> </span><a href="#local-6989586621679060826"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Text.ParserCombinators.ReadP.html#ReadP"><span class="hs-identifier hs-type">ReadP</span></a><span> </span><a href="#local-6989586621679060827"><span class="hs-identifier hs-type">sep</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Text.ParserCombinators.ReadP.html#ReadP"><span class="hs-identifier hs-type">ReadP</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621679060826"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span>
</span><a name="line-361"></a><span class="hs-comment">-- ^ @sepBy p sep@ parses zero or more occurrences of @p@, separated by @sep@.</span><span>
</span><a name="line-362"></a><span class="hs-comment">--   Returns a list of values returned by @p@.</span><span>
</span><a name="line-363"></a><a name="sepBy"><a href="Text.ParserCombinators.ReadP.html#sepBy"><span class="hs-identifier">sepBy</span></a></a><span> </span><a name="local-6989586621679060929"><a href="#local-6989586621679060929"><span class="hs-identifier">p</span></a></a><span> </span><a name="local-6989586621679060930"><a href="#local-6989586621679060930"><span class="hs-identifier">sep</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Text.ParserCombinators.ReadP.html#sepBy1"><span class="hs-identifier hs-var">sepBy1</span></a><span> </span><a href="#local-6989586621679060929"><span class="hs-identifier hs-var">p</span></a><span> </span><a href="#local-6989586621679060930"><span class="hs-identifier hs-var">sep</span></a><span> </span><a href="Text.ParserCombinators.ReadP.html#%2B%2B%2B"><span class="hs-operator hs-var">+++</span></a><span> </span><a href="GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-364"></a><span>
</span><a name="line-365"></a><span class="hs-identifier">sepBy1</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Text.ParserCombinators.ReadP.html#ReadP"><span class="hs-identifier hs-type">ReadP</span></a><span> </span><a href="#local-6989586621679060824"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Text.ParserCombinators.ReadP.html#ReadP"><span class="hs-identifier hs-type">ReadP</span></a><span> </span><a href="#local-6989586621679060825"><span class="hs-identifier hs-type">sep</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Text.ParserCombinators.ReadP.html#ReadP"><span class="hs-identifier hs-type">ReadP</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621679060824"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span>
</span><a name="line-366"></a><span class="hs-comment">-- ^ @sepBy1 p sep@ parses one or more occurrences of @p@, separated by @sep@.</span><span>
</span><a name="line-367"></a><span class="hs-comment">--   Returns a list of values returned by @p@.</span><span>
</span><a name="line-368"></a><a name="sepBy1"><a href="Text.ParserCombinators.ReadP.html#sepBy1"><span class="hs-identifier">sepBy1</span></a></a><span> </span><a name="local-6989586621679060931"><a href="#local-6989586621679060931"><span class="hs-identifier">p</span></a></a><span> </span><a name="local-6989586621679060932"><a href="#local-6989586621679060932"><span class="hs-identifier">sep</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="GHC.Base.html#liftM2"><span class="hs-identifier hs-var">liftM2</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">:</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679060931"><span class="hs-identifier hs-var">p</span></a><span> </span><span class="hs-special">(</span><a href="Text.ParserCombinators.ReadP.html#many"><span class="hs-identifier hs-var">many</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679060932"><span class="hs-identifier hs-var">sep</span></a><span> </span><a href="GHC.Base.html#%3E%3E"><span class="hs-operator hs-var">&gt;&gt;</span></a><span> </span><a href="#local-6989586621679060931"><span class="hs-identifier hs-var">p</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-369"></a><span>
</span><a name="line-370"></a><span class="hs-identifier">endBy</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Text.ParserCombinators.ReadP.html#ReadP"><span class="hs-identifier hs-type">ReadP</span></a><span> </span><a href="#local-6989586621679060822"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Text.ParserCombinators.ReadP.html#ReadP"><span class="hs-identifier hs-type">ReadP</span></a><span> </span><a href="#local-6989586621679060823"><span class="hs-identifier hs-type">sep</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Text.ParserCombinators.ReadP.html#ReadP"><span class="hs-identifier hs-type">ReadP</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621679060822"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span>
</span><a name="line-371"></a><span class="hs-comment">-- ^ @endBy p sep@ parses zero or more occurrences of @p@, separated and ended</span><span>
</span><a name="line-372"></a><span class="hs-comment">--   by @sep@.</span><span>
</span><a name="line-373"></a><a name="endBy"><a href="Text.ParserCombinators.ReadP.html#endBy"><span class="hs-identifier">endBy</span></a></a><span> </span><a name="local-6989586621679060933"><a href="#local-6989586621679060933"><span class="hs-identifier">p</span></a></a><span> </span><a name="local-6989586621679060934"><a href="#local-6989586621679060934"><span class="hs-identifier">sep</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Text.ParserCombinators.ReadP.html#many"><span class="hs-identifier hs-var">many</span></a><span> </span><span class="hs-special">(</span><span class="hs-keyword">do</span><span> </span><a name="local-6989586621679060935"><a href="#local-6989586621679060935"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679060933"><span class="hs-identifier hs-var">p</span></a><span> </span><span class="hs-special">;</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679060934"><span class="hs-identifier hs-var">sep</span></a><span> </span><span class="hs-special">;</span><span> </span><a href="GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><a href="#local-6989586621679060935"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span>
</span><a name="line-374"></a><span>
</span><a name="line-375"></a><span class="hs-identifier">endBy1</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Text.ParserCombinators.ReadP.html#ReadP"><span class="hs-identifier hs-type">ReadP</span></a><span> </span><a href="#local-6989586621679060820"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Text.ParserCombinators.ReadP.html#ReadP"><span class="hs-identifier hs-type">ReadP</span></a><span> </span><a href="#local-6989586621679060821"><span class="hs-identifier hs-type">sep</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Text.ParserCombinators.ReadP.html#ReadP"><span class="hs-identifier hs-type">ReadP</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621679060820"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span>
</span><a name="line-376"></a><span class="hs-comment">-- ^ @endBy p sep@ parses one or more occurrences of @p@, separated and ended</span><span>
</span><a name="line-377"></a><span class="hs-comment">--   by @sep@.</span><span>
</span><a name="line-378"></a><a name="endBy1"><a href="Text.ParserCombinators.ReadP.html#endBy1"><span class="hs-identifier">endBy1</span></a></a><span> </span><a name="local-6989586621679060936"><a href="#local-6989586621679060936"><span class="hs-identifier">p</span></a></a><span> </span><a name="local-6989586621679060937"><a href="#local-6989586621679060937"><span class="hs-identifier">sep</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Text.ParserCombinators.ReadP.html#many1"><span class="hs-identifier hs-var">many1</span></a><span> </span><span class="hs-special">(</span><span class="hs-keyword">do</span><span> </span><a name="local-6989586621679060938"><a href="#local-6989586621679060938"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679060936"><span class="hs-identifier hs-var">p</span></a><span> </span><span class="hs-special">;</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679060937"><span class="hs-identifier hs-var">sep</span></a><span> </span><span class="hs-special">;</span><span> </span><a href="GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><a href="#local-6989586621679060938"><span class="hs-identifier hs-var">x</span></a><span class="hs-special">)</span><span>
</span><a name="line-379"></a><span>
</span><a name="line-380"></a><span class="hs-identifier">chainr</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Text.ParserCombinators.ReadP.html#ReadP"><span class="hs-identifier hs-type">ReadP</span></a><span> </span><a href="#local-6989586621679060819"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Text.ParserCombinators.ReadP.html#ReadP"><span class="hs-identifier hs-type">ReadP</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679060819"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679060819"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679060819"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679060819"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Text.ParserCombinators.ReadP.html#ReadP"><span class="hs-identifier hs-type">ReadP</span></a><span> </span><a href="#local-6989586621679060819"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-381"></a><span class="hs-comment">-- ^ @chainr p op x@ parses zero or more occurrences of @p@, separated by @op@.</span><span>
</span><a name="line-382"></a><span class="hs-comment">--   Returns a value produced by a /right/ associative application of all</span><span>
</span><a name="line-383"></a><span class="hs-comment">--   functions returned by @op@. If there are no occurrences of @p@, @x@ is</span><span>
</span><a name="line-384"></a><span class="hs-comment">--   returned.</span><span>
</span><a name="line-385"></a><a name="chainr"><a href="Text.ParserCombinators.ReadP.html#chainr"><span class="hs-identifier">chainr</span></a></a><span> </span><a name="local-6989586621679060939"><a href="#local-6989586621679060939"><span class="hs-identifier">p</span></a></a><span> </span><a name="local-6989586621679060940"><a href="#local-6989586621679060940"><span class="hs-identifier">op</span></a></a><span> </span><a name="local-6989586621679060941"><a href="#local-6989586621679060941"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Text.ParserCombinators.ReadP.html#chainr1"><span class="hs-identifier hs-var">chainr1</span></a><span> </span><a href="#local-6989586621679060939"><span class="hs-identifier hs-var">p</span></a><span> </span><a href="#local-6989586621679060940"><span class="hs-identifier hs-var">op</span></a><span> </span><a href="Text.ParserCombinators.ReadP.html#%2B%2B%2B"><span class="hs-operator hs-var">+++</span></a><span> </span><a href="GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><a href="#local-6989586621679060941"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-386"></a><span>
</span><a name="line-387"></a><span class="hs-identifier">chainl</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Text.ParserCombinators.ReadP.html#ReadP"><span class="hs-identifier hs-type">ReadP</span></a><span> </span><a href="#local-6989586621679060818"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Text.ParserCombinators.ReadP.html#ReadP"><span class="hs-identifier hs-type">ReadP</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679060818"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679060818"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679060818"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679060818"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Text.ParserCombinators.ReadP.html#ReadP"><span class="hs-identifier hs-type">ReadP</span></a><span> </span><a href="#local-6989586621679060818"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-388"></a><span class="hs-comment">-- ^ @chainl p op x@ parses zero or more occurrences of @p@, separated by @op@.</span><span>
</span><a name="line-389"></a><span class="hs-comment">--   Returns a value produced by a /left/ associative application of all</span><span>
</span><a name="line-390"></a><span class="hs-comment">--   functions returned by @op@. If there are no occurrences of @p@, @x@ is</span><span>
</span><a name="line-391"></a><span class="hs-comment">--   returned.</span><span>
</span><a name="line-392"></a><a name="chainl"><a href="Text.ParserCombinators.ReadP.html#chainl"><span class="hs-identifier">chainl</span></a></a><span> </span><a name="local-6989586621679060942"><a href="#local-6989586621679060942"><span class="hs-identifier">p</span></a></a><span> </span><a name="local-6989586621679060943"><a href="#local-6989586621679060943"><span class="hs-identifier">op</span></a></a><span> </span><a name="local-6989586621679060944"><a href="#local-6989586621679060944"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Text.ParserCombinators.ReadP.html#chainl1"><span class="hs-identifier hs-var">chainl1</span></a><span> </span><a href="#local-6989586621679060942"><span class="hs-identifier hs-var">p</span></a><span> </span><a href="#local-6989586621679060943"><span class="hs-identifier hs-var">op</span></a><span> </span><a href="Text.ParserCombinators.ReadP.html#%2B%2B%2B"><span class="hs-operator hs-var">+++</span></a><span> </span><a href="GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><a href="#local-6989586621679060944"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-393"></a><span>
</span><a name="line-394"></a><span class="hs-identifier">chainr1</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Text.ParserCombinators.ReadP.html#ReadP"><span class="hs-identifier hs-type">ReadP</span></a><span> </span><a href="#local-6989586621679060817"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Text.ParserCombinators.ReadP.html#ReadP"><span class="hs-identifier hs-type">ReadP</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679060817"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679060817"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679060817"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Text.ParserCombinators.ReadP.html#ReadP"><span class="hs-identifier hs-type">ReadP</span></a><span> </span><a href="#local-6989586621679060817"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-395"></a><span class="hs-comment">-- ^ Like 'chainr', but parses one or more occurrences of @p@.</span><span>
</span><a name="line-396"></a><a name="chainr1"><a href="Text.ParserCombinators.ReadP.html#chainr1"><span class="hs-identifier">chainr1</span></a></a><span> </span><a name="local-6989586621679060945"><a href="#local-6989586621679060945"><span class="hs-identifier">p</span></a></a><span> </span><a name="local-6989586621679060946"><a href="#local-6989586621679060946"><span class="hs-identifier">op</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679060947"><span class="hs-identifier hs-var">scan</span></a><span>
</span><a name="line-397"></a><span>  </span><span class="hs-keyword">where</span><span> </span><a name="local-6989586621679060947"><a href="#local-6989586621679060947"><span class="hs-identifier">scan</span></a></a><span>   </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679060945"><span class="hs-identifier hs-var">p</span></a><span> </span><a href="GHC.Base.html#%3E%3E%3D"><span class="hs-operator hs-var">&gt;&gt;=</span></a><span> </span><a href="#local-6989586621679060948"><span class="hs-identifier hs-var">rest</span></a><span>
</span><a name="line-398"></a><span>        </span><a name="local-6989586621679060948"><a href="#local-6989586621679060948"><span class="hs-identifier">rest</span></a></a><span> </span><a name="local-6989586621679060949"><a href="#local-6989586621679060949"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><a name="local-6989586621679060950"><a href="#local-6989586621679060950"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679060946"><span class="hs-identifier hs-var">op</span></a><span>
</span><a name="line-399"></a><span>                    </span><a name="local-6989586621679060951"><a href="#local-6989586621679060951"><span class="hs-identifier">y</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679060947"><span class="hs-identifier hs-var">scan</span></a><span>
</span><a name="line-400"></a><span>                    </span><a href="GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679060950"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679060949"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-6989586621679060951"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">)</span><span>
</span><a name="line-401"></a><span>                 </span><a href="Text.ParserCombinators.ReadP.html#%2B%2B%2B"><span class="hs-operator hs-var">+++</span></a><span> </span><a href="GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><a href="#local-6989586621679060949"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-402"></a><span>
</span><a name="line-403"></a><span class="hs-identifier">chainl1</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Text.ParserCombinators.ReadP.html#ReadP"><span class="hs-identifier hs-type">ReadP</span></a><span> </span><a href="#local-6989586621679060816"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Text.ParserCombinators.ReadP.html#ReadP"><span class="hs-identifier hs-type">ReadP</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679060816"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679060816"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679060816"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Text.ParserCombinators.ReadP.html#ReadP"><span class="hs-identifier hs-type">ReadP</span></a><span> </span><a href="#local-6989586621679060816"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-404"></a><span class="hs-comment">-- ^ Like 'chainl', but parses one or more occurrences of @p@.</span><span>
</span><a name="line-405"></a><a name="chainl1"><a href="Text.ParserCombinators.ReadP.html#chainl1"><span class="hs-identifier">chainl1</span></a></a><span> </span><a name="local-6989586621679060952"><a href="#local-6989586621679060952"><span class="hs-identifier">p</span></a></a><span> </span><a name="local-6989586621679060953"><a href="#local-6989586621679060953"><span class="hs-identifier">op</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679060952"><span class="hs-identifier hs-var">p</span></a><span> </span><a href="GHC.Base.html#%3E%3E%3D"><span class="hs-operator hs-var">&gt;&gt;=</span></a><span> </span><a href="#local-6989586621679060954"><span class="hs-identifier hs-var">rest</span></a><span>
</span><a name="line-406"></a><span>  </span><span class="hs-keyword">where</span><span> </span><a name="local-6989586621679060954"><a href="#local-6989586621679060954"><span class="hs-identifier">rest</span></a></a><span> </span><a name="local-6989586621679060955"><a href="#local-6989586621679060955"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><a name="local-6989586621679060956"><a href="#local-6989586621679060956"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679060953"><span class="hs-identifier hs-var">op</span></a><span>
</span><a name="line-407"></a><span>                    </span><a name="local-6989586621679060957"><a href="#local-6989586621679060957"><span class="hs-identifier">y</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679060952"><span class="hs-identifier hs-var">p</span></a><span>
</span><a name="line-408"></a><span>                    </span><a href="#local-6989586621679060954"><span class="hs-identifier hs-var">rest</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679060956"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679060955"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-6989586621679060957"><span class="hs-identifier hs-var">y</span></a><span class="hs-special">)</span><span>
</span><a name="line-409"></a><span>                 </span><a href="Text.ParserCombinators.ReadP.html#%2B%2B%2B"><span class="hs-operator hs-var">+++</span></a><span> </span><a href="GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><a href="#local-6989586621679060955"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-410"></a><span>
</span><a name="line-411"></a><span class="hs-identifier">manyTill</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Text.ParserCombinators.ReadP.html#ReadP"><span class="hs-identifier hs-type">ReadP</span></a><span> </span><a href="#local-6989586621679060814"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Text.ParserCombinators.ReadP.html#ReadP"><span class="hs-identifier hs-type">ReadP</span></a><span> </span><a href="#local-6989586621679060815"><span class="hs-identifier hs-type">end</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Text.ParserCombinators.ReadP.html#ReadP"><span class="hs-identifier hs-type">ReadP</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621679060814"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span>
</span><a name="line-412"></a><span class="hs-comment">-- ^ @manyTill p end@ parses zero or more occurrences of @p@, until @end@</span><span>
</span><a name="line-413"></a><span class="hs-comment">--   succeeds. Returns a list of values returned by @p@.</span><span>
</span><a name="line-414"></a><a name="manyTill"><a href="Text.ParserCombinators.ReadP.html#manyTill"><span class="hs-identifier">manyTill</span></a></a><span> </span><a name="local-6989586621679060958"><a href="#local-6989586621679060958"><span class="hs-identifier">p</span></a></a><span> </span><a name="local-6989586621679060959"><a href="#local-6989586621679060959"><span class="hs-identifier">end</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679060960"><span class="hs-identifier hs-var">scan</span></a><span>
</span><a name="line-415"></a><span>  </span><span class="hs-keyword">where</span><span> </span><a name="local-6989586621679060960"><a href="#local-6989586621679060960"><span class="hs-identifier">scan</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679060959"><span class="hs-identifier hs-var">end</span></a><span> </span><a href="GHC.Base.html#%3E%3E"><span class="hs-operator hs-var">&gt;&gt;</span></a><span> </span><a href="GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><a href="Text.ParserCombinators.ReadP.html#%3C%2B%2B"><span class="hs-operator hs-var">&lt;++</span></a><span> </span><span class="hs-special">(</span><a href="GHC.Base.html#liftM2"><span class="hs-identifier hs-var">liftM2</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">:</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679060958"><span class="hs-identifier hs-var">p</span></a><span> </span><a href="#local-6989586621679060960"><span class="hs-identifier hs-var">scan</span></a><span class="hs-special">)</span><span>
</span><a name="line-416"></a><span>
</span><a name="line-417"></a><span class="hs-comment">-- ---------------------------------------------------------------------------</span><span>
</span><a name="line-418"></a><span class="hs-comment">-- Converting between ReadP and Read</span><span>
</span><a name="line-419"></a><span>
</span><a name="line-420"></a><span class="hs-identifier">readP_to_S</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Text.ParserCombinators.ReadP.html#ReadP"><span class="hs-identifier hs-type">ReadP</span></a><span> </span><a href="#local-6989586621679060813"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Text.ParserCombinators.ReadP.html#ReadS"><span class="hs-identifier hs-type">ReadS</span></a><span> </span><a href="#local-6989586621679060813"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-421"></a><span class="hs-comment">-- ^ Converts a parser into a Haskell ReadS-style function.</span><span>
</span><a name="line-422"></a><span class="hs-comment">--   This is the main way in which you can \&quot;run\&quot; a 'ReadP' parser:</span><span>
</span><a name="line-423"></a><span class="hs-comment">--   the expanded type is</span><span>
</span><a name="line-424"></a><span class="hs-comment">-- @ readP_to_S :: ReadP a -&gt; String -&gt; [(a,String)] @</span><span>
</span><a name="line-425"></a><a name="readP_to_S"><a href="Text.ParserCombinators.ReadP.html#readP_to_S"><span class="hs-identifier">readP_to_S</span></a></a><span> </span><span class="hs-special">(</span><a href="Text.ParserCombinators.ReadP.html#R"><span class="hs-identifier hs-var">R</span></a><span> </span><a name="local-6989586621679060961"><a href="#local-6989586621679060961"><span class="hs-identifier">f</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Text.ParserCombinators.ReadP.html#run"><span class="hs-identifier hs-var">run</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679060961"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="GHC.Base.html#return"><span class="hs-identifier hs-var">return</span></a><span class="hs-special">)</span><span>
</span><a name="line-426"></a><span>
</span><a name="line-427"></a><span class="hs-identifier">readS_to_P</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Text.ParserCombinators.ReadP.html#ReadS"><span class="hs-identifier hs-type">ReadS</span></a><span> </span><a href="#local-6989586621679060812"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Text.ParserCombinators.ReadP.html#ReadP"><span class="hs-identifier hs-type">ReadP</span></a><span> </span><a href="#local-6989586621679060812"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-428"></a><span class="hs-comment">-- ^ Converts a Haskell ReadS-style function into a parser.</span><span>
</span><a name="line-429"></a><span class="hs-comment">--   Warning: This introduces local backtracking in the resulting</span><span>
</span><a name="line-430"></a><span class="hs-comment">--   parser, and therefore a possible inefficiency.</span><span>
</span><a name="line-431"></a><a name="readS_to_P"><a href="Text.ParserCombinators.ReadP.html#readS_to_P"><span class="hs-identifier">readS_to_P</span></a></a><span> </span><a name="local-6989586621679060962"><a href="#local-6989586621679060962"><span class="hs-identifier">r</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-432"></a><span>  </span><a href="Text.ParserCombinators.ReadP.html#R"><span class="hs-identifier hs-var">R</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679060963"><a href="#local-6989586621679060963"><span class="hs-identifier">k</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Text.ParserCombinators.ReadP.html#Look"><span class="hs-identifier hs-var">Look</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679060964"><a href="#local-6989586621679060964"><span class="hs-identifier">s</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Text.ParserCombinators.ReadP.html#final"><span class="hs-identifier hs-var">final</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621679060967"><span class="hs-identifier hs-var">bs''</span></a><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679060965"><a href="#local-6989586621679060965"><span class="hs-identifier">a</span></a></a><span class="hs-special">,</span><a name="local-6989586621679060966"><a href="#local-6989586621679060966"><span class="hs-identifier">s'</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679060962"><span class="hs-identifier hs-var">r</span></a><span> </span><a href="#local-6989586621679060964"><span class="hs-identifier hs-var">s</span></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679060967"><a href="#local-6989586621679060967"><span class="hs-identifier">bs''</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Text.ParserCombinators.ReadP.html#run"><span class="hs-identifier hs-var">run</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679060963"><span class="hs-identifier hs-var">k</span></a><span> </span><a href="#local-6989586621679060965"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679060966"><span class="hs-identifier hs-var">s'</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-433"></a><span>
</span><a name="line-434"></a><span class="hs-comment">-- ---------------------------------------------------------------------------</span><span>
</span><a name="line-435"></a><span class="hs-comment">-- QuickCheck properties that hold for the combinators</span><span>
</span><a name="line-436"></a><span>
</span><a name="line-437"></a><span class="hs-comment">{- $properties
The following are QuickCheck specifications of what the combinators do.
These can be seen as formal specifications of the behavior of the
combinators.

We use bags to give semantics to the combinators.

&gt;  type Bag a = [a]

Equality on bags does not care about the order of elements.

&gt;  (=~) :: Ord a =&gt; Bag a -&gt; Bag a -&gt; Bool
&gt;  xs =~ ys = sort xs == sort ys

A special equality operator to avoid unresolved overloading
when testing the properties.

&gt;  (=~.) :: Bag (Int,String) -&gt; Bag (Int,String) -&gt; Bool
&gt;  (=~.) = (=~)

Here follow the properties:

&gt;  prop_Get_Nil =
&gt;    readP_to_S get [] =~ []
&gt;
&gt;  prop_Get_Cons c s =
&gt;    readP_to_S get (c:s) =~ [(c,s)]
&gt;
&gt;  prop_Look s =
&gt;    readP_to_S look s =~ [(s,s)]
&gt;
&gt;  prop_Fail s =
&gt;    readP_to_S pfail s =~. []
&gt;
&gt;  prop_Return x s =
&gt;    readP_to_S (return x) s =~. [(x,s)]
&gt;
&gt;  prop_Bind p k s =
&gt;    readP_to_S (p &gt;&gt;= k) s =~.
&gt;      [ ys''
&gt;      | (x,s') &lt;- readP_to_S p s
&gt;      , ys''   &lt;- readP_to_S (k (x::Int)) s'
&gt;      ]
&gt;
&gt;  prop_Plus p q s =
&gt;    readP_to_S (p +++ q) s =~.
&gt;      (readP_to_S p s ++ readP_to_S q s)
&gt;
&gt;  prop_LeftPlus p q s =
&gt;    readP_to_S (p &lt;++ q) s =~.
&gt;      (readP_to_S p s +&lt;+ readP_to_S q s)
&gt;   where
&gt;    [] +&lt;+ ys = ys
&gt;    xs +&lt;+ _  = xs
&gt;
&gt;  prop_Gather s =
&gt;    forAll readPWithoutReadS $ \p -&gt;
&gt;      readP_to_S (gather p) s =~
&gt;        [ ((pre,x::Int),s')
&gt;        | (x,s') &lt;- readP_to_S p s
&gt;        , let pre = take (length s - length s') s
&gt;        ]
&gt;
&gt;  prop_String_Yes this s =
&gt;    readP_to_S (string this) (this ++ s) =~
&gt;      [(this,s)]
&gt;
&gt;  prop_String_Maybe this s =
&gt;    readP_to_S (string this) s =~
&gt;      [(this, drop (length this) s) | this `isPrefixOf` s]
&gt;
&gt;  prop_Munch p s =
&gt;    readP_to_S (munch p) s =~
&gt;      [(takeWhile p s, dropWhile p s)]
&gt;
&gt;  prop_Munch1 p s =
&gt;    readP_to_S (munch1 p) s =~
&gt;      [(res,s') | let (res,s') = (takeWhile p s, dropWhile p s), not (null res)]
&gt;
&gt;  prop_Choice ps s =
&gt;    readP_to_S (choice ps) s =~.
&gt;      readP_to_S (foldr (+++) pfail ps) s
&gt;
&gt;  prop_ReadS r s =
&gt;    readP_to_S (readS_to_P r) s =~. r s
-}</span><span>
</span><a name="line-523"></a><span>
</span><a name="line-524"></a></pre></body></html>