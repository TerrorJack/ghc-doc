<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE CPP, GADTs, ScopedTypeVariables #-}</span><span>
</span><a name="line-2"></a><span class="hs-cpp">#if __GLASGOW_HASKELL__ &gt;= 701</span><span>
</span><a name="line-3"></a><span class="hs-pragma">{-# LANGUAGE Safe #-}</span><span>
</span><a name="line-4"></a><span class="hs-cpp">#endif</span><span>
</span><a name="line-5"></a><span>
</span><a name="line-6"></a><span class="hs-comment">-- | Possibly doubly pointed lattices</span><span>
</span><a name="line-7"></a><span>
</span><a name="line-8"></a><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Compiler</span><span class="hs-operator">.</span><span class="hs-identifier">Hoopl</span><span class="hs-operator">.</span><span class="hs-identifier">Pointed</span><span>
</span><a name="line-9"></a><span>  </span><span class="hs-special">(</span><span> </span><a href="Compiler.Hoopl.Pointed.html#Pointed"><span class="hs-identifier hs-type">Pointed</span></a><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><a href="Compiler.Hoopl.Pointed.html#addPoints"><span class="hs-identifier hs-var">addPoints</span></a><span class="hs-special">,</span><span> </span><a href="Compiler.Hoopl.Pointed.html#addPoints%27"><span class="hs-identifier hs-var">addPoints'</span></a><span class="hs-special">,</span><span> </span><a href="Compiler.Hoopl.Pointed.html#addTop"><span class="hs-identifier hs-var">addTop</span></a><span class="hs-special">,</span><span> </span><a href="Compiler.Hoopl.Pointed.html#addTop%27"><span class="hs-identifier hs-var">addTop'</span></a><span>
</span><a name="line-10"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Compiler.Hoopl.Pointed.html#liftJoinTop"><span class="hs-identifier hs-var">liftJoinTop</span></a><span class="hs-special">,</span><span> </span><a href="Compiler.Hoopl.Pointed.html#extendJoinDomain"><span class="hs-identifier hs-var">extendJoinDomain</span></a><span>
</span><a name="line-11"></a><span>  </span><span class="hs-special">,</span><span> </span><a href="Compiler.Hoopl.Pointed.html#WithTop"><span class="hs-identifier hs-type">WithTop</span></a><span class="hs-special">,</span><span> </span><a href="Compiler.Hoopl.Pointed.html#WithBot"><span class="hs-identifier hs-type">WithBot</span></a><span class="hs-special">,</span><span> </span><a href="Compiler.Hoopl.Pointed.html#WithTopAndBot"><span class="hs-identifier hs-type">WithTopAndBot</span></a><span>
</span><a name="line-12"></a><span>  </span><span class="hs-special">)</span><span>
</span><a name="line-13"></a><span class="hs-keyword">where</span><span>
</span><a name="line-14"></a><span>
</span><a name="line-15"></a><span class="hs-keyword">import</span><span> </span><a href="Compiler.Hoopl.Block.html"><span class="hs-identifier">Compiler</span><span class="hs-operator">.</span><span class="hs-identifier">Hoopl</span><span class="hs-operator">.</span><span class="hs-identifier">Block</span></a><span>
</span><a name="line-16"></a><span class="hs-keyword">import</span><span> </span><a href="Compiler.Hoopl.Label.html"><span class="hs-identifier">Compiler</span><span class="hs-operator">.</span><span class="hs-identifier">Hoopl</span><span class="hs-operator">.</span><span class="hs-identifier">Label</span></a><span>
</span><a name="line-17"></a><span class="hs-keyword">import</span><span> </span><a href="Compiler.Hoopl.Dataflow.html"><span class="hs-identifier">Compiler</span><span class="hs-operator">.</span><span class="hs-identifier">Hoopl</span><span class="hs-operator">.</span><span class="hs-identifier">Dataflow</span></a><span>
</span><a name="line-18"></a><span>
</span><a name="line-19"></a><span class="hs-comment">-- | Adds top, bottom, or both to help form a lattice</span><span>
</span><a name="line-20"></a><span class="hs-keyword">data</span><span> </span><a name="Pointed"><a href="Compiler.Hoopl.Pointed.html#Pointed"><span class="hs-identifier">Pointed</span></a></a><span> </span><a name="local-6989586621679059428"><a href="#local-6989586621679059428"><span class="hs-identifier">t</span></a></a><span> </span><a name="local-6989586621679059429"><a href="#local-6989586621679059429"><span class="hs-identifier">b</span></a></a><span> </span><a name="local-6989586621679059430"><a href="#local-6989586621679059430"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-21"></a><span>   </span><a name="Bot"><a href="Compiler.Hoopl.Pointed.html#Bot"><span class="hs-identifier">Bot</span></a></a><span>   </span><span class="hs-glyph">::</span><span>      </span><a href="Compiler.Hoopl.Pointed.html#Pointed"><span class="hs-identifier hs-type">Pointed</span></a><span> </span><a href="#local-6989586621679059431"><span class="hs-identifier hs-type">t</span></a><span> </span><a href="Compiler.Hoopl.Block.html#C"><span class="hs-identifier hs-type">C</span></a><span> </span><a href="#local-6989586621679059432"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-22"></a><span>   </span><a name="PElem"><a href="Compiler.Hoopl.Pointed.html#PElem"><span class="hs-identifier">PElem</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="#local-6989586621679059433"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Compiler.Hoopl.Pointed.html#Pointed"><span class="hs-identifier hs-type">Pointed</span></a><span> </span><a href="#local-6989586621679059434"><span class="hs-identifier hs-type">t</span></a><span> </span><a href="#local-6989586621679059435"><span class="hs-identifier hs-type">b</span></a><span> </span><a href="#local-6989586621679059433"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-23"></a><span>   </span><a name="Top"><a href="Compiler.Hoopl.Pointed.html#Top"><span class="hs-identifier">Top</span></a></a><span>   </span><span class="hs-glyph">::</span><span>      </span><a href="Compiler.Hoopl.Pointed.html#Pointed"><span class="hs-identifier hs-type">Pointed</span></a><span> </span><a href="Compiler.Hoopl.Block.html#C"><span class="hs-identifier hs-type">C</span></a><span> </span><a href="#local-6989586621679059436"><span class="hs-identifier hs-type">b</span></a><span> </span><a href="#local-6989586621679059437"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-24"></a><span>
</span><a name="line-25"></a><span class="hs-comment">-- ^ The type parameters 't' and 'b' are used to say whether top</span><span>
</span><a name="line-26"></a><span class="hs-comment">-- and bottom elements have been added.  The analogy with 'Block'</span><span>
</span><a name="line-27"></a><span class="hs-comment">-- is nearly exact:</span><span>
</span><a name="line-28"></a><span class="hs-comment">--</span><span>
</span><a name="line-29"></a><span class="hs-comment">--  * A 'Block' is closed at the entry if and only if it has a first node;</span><span>
</span><a name="line-30"></a><span class="hs-comment">--    a 'Pointed' is closed at the top if and only if it has a top element.</span><span>
</span><a name="line-31"></a><span class="hs-comment">--</span><span>
</span><a name="line-32"></a><span class="hs-comment">--  * A 'Block' is closed at the exit if and only if it has a last node;</span><span>
</span><a name="line-33"></a><span class="hs-comment">--    a 'Pointed' is closed at the bottom if and only if it has a bottom element.</span><span>
</span><a name="line-34"></a><span class="hs-comment">--</span><span>
</span><a name="line-35"></a><span class="hs-comment">-- We thus have four possible types, of which three are interesting:</span><span>
</span><a name="line-36"></a><span class="hs-comment">--</span><span>
</span><a name="line-37"></a><span class="hs-comment">--  [@Pointed C C a@] Type @a@ extended with both top and bottom elements.</span><span>
</span><a name="line-38"></a><span class="hs-comment">--</span><span>
</span><a name="line-39"></a><span class="hs-comment">--  [@Pointed C O a@] Type @a@ extended with a top element</span><span>
</span><a name="line-40"></a><span class="hs-comment">--  only. (Presumably @a@ comes equipped with a bottom element of its own.)</span><span>
</span><a name="line-41"></a><span class="hs-comment">--</span><span>
</span><a name="line-42"></a><span class="hs-comment">--  [@Pointed O C a@] Type @a@ extended with a bottom element only. </span><span>
</span><a name="line-43"></a><span class="hs-comment">--</span><span>
</span><a name="line-44"></a><span class="hs-comment">--  [@Pointed O O a@] Isomorphic to @a@, and therefore not interesting.</span><span>
</span><a name="line-45"></a><span class="hs-comment">--</span><span>
</span><a name="line-46"></a><span class="hs-comment">-- The advantage of all this GADT-ishness is that the constructors</span><span>
</span><a name="line-47"></a><span class="hs-comment">-- 'Bot', 'Top', and 'PElem' can all be used polymorphically.</span><span>
</span><a name="line-48"></a><span class="hs-comment">--</span><span>
</span><a name="line-49"></a><span class="hs-comment">-- A 'Pointed t b' type is an instance of 'Functor' and 'Show'.</span><span>
</span><a name="line-50"></a><span>
</span><a name="line-51"></a><span>
</span><a name="line-52"></a><span>
</span><a name="line-53"></a><span class="hs-keyword">type</span><span> </span><a name="WithBot"><a href="Compiler.Hoopl.Pointed.html#WithBot"><span class="hs-identifier">WithBot</span></a></a><span> </span><a name="local-6989586621679059427"><a href="#local-6989586621679059427"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Compiler.Hoopl.Pointed.html#Pointed"><span class="hs-identifier hs-type">Pointed</span></a><span> </span><a href="Compiler.Hoopl.Block.html#O"><span class="hs-identifier hs-type">O</span></a><span> </span><a href="Compiler.Hoopl.Block.html#C"><span class="hs-identifier hs-type">C</span></a><span> </span><a href="#local-6989586621679059427"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-54"></a><span class="hs-comment">-- ^ Type 'a' with a bottom element adjoined</span><span>
</span><a name="line-55"></a><span>
</span><a name="line-56"></a><span class="hs-keyword">type</span><span> </span><a name="WithTop"><a href="Compiler.Hoopl.Pointed.html#WithTop"><span class="hs-identifier">WithTop</span></a></a><span> </span><a name="local-6989586621679059426"><a href="#local-6989586621679059426"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Compiler.Hoopl.Pointed.html#Pointed"><span class="hs-identifier hs-type">Pointed</span></a><span> </span><a href="Compiler.Hoopl.Block.html#C"><span class="hs-identifier hs-type">C</span></a><span> </span><a href="Compiler.Hoopl.Block.html#O"><span class="hs-identifier hs-type">O</span></a><span> </span><a href="#local-6989586621679059426"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-57"></a><span class="hs-comment">-- ^ Type 'a' with a top element adjoined</span><span>
</span><a name="line-58"></a><span>
</span><a name="line-59"></a><span class="hs-keyword">type</span><span> </span><a name="WithTopAndBot"><a href="Compiler.Hoopl.Pointed.html#WithTopAndBot"><span class="hs-identifier">WithTopAndBot</span></a></a><span> </span><a name="local-6989586621679059425"><a href="#local-6989586621679059425"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Compiler.Hoopl.Pointed.html#Pointed"><span class="hs-identifier hs-type">Pointed</span></a><span> </span><a href="Compiler.Hoopl.Block.html#C"><span class="hs-identifier hs-type">C</span></a><span> </span><a href="Compiler.Hoopl.Block.html#C"><span class="hs-identifier hs-type">C</span></a><span> </span><a href="#local-6989586621679059425"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-60"></a><span class="hs-comment">-- ^ Type 'a' with top and bottom elements adjoined</span><span>
</span><a name="line-61"></a><span>
</span><a name="line-62"></a><span>
</span><a name="line-63"></a><span class="hs-comment">-- | Given a join function and a name, creates a semi lattice by</span><span>
</span><a name="line-64"></a><span class="hs-comment">-- adding a bottom element, and possibly a top element also.</span><span>
</span><a name="line-65"></a><span class="hs-comment">-- A specialized version of 'addPoints''.</span><span>
</span><a name="line-66"></a><span class="hs-identifier">addPoints</span><span>  </span><span class="hs-glyph">::</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#String"><span class="hs-identifier hs-type">String</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Compiler.Hoopl.Dataflow.html#JoinFun"><span class="hs-identifier hs-type">JoinFun</span></a><span> </span><a href="#local-6989586621679059462"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Compiler.Hoopl.Dataflow.html#DataflowLattice"><span class="hs-identifier hs-type">DataflowLattice</span></a><span> </span><span class="hs-special">(</span><a href="Compiler.Hoopl.Pointed.html#Pointed"><span class="hs-identifier hs-type">Pointed</span></a><span> </span><a href="#local-6989586621679059463"><span class="hs-identifier hs-type">t</span></a><span> </span><a href="Compiler.Hoopl.Block.html#C"><span class="hs-identifier hs-type">C</span></a><span> </span><a href="#local-6989586621679059462"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-67"></a><span class="hs-comment">-- | A more general case for creating a new lattice</span><span>
</span><a name="line-68"></a><span class="hs-identifier">addPoints'</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><a name="local-6989586621679059460"><a href="#local-6989586621679059460"><span class="hs-identifier">a</span></a></a><span> </span><a name="local-6989586621679059461"><a href="#local-6989586621679059461"><span class="hs-identifier">t</span></a></a><span> </span><span class="hs-operator">.</span><span>
</span><a name="line-69"></a><span>              </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#String"><span class="hs-identifier hs-type">String</span></a><span>
</span><a name="line-70"></a><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="Compiler.Hoopl.Label.html#Label"><span class="hs-identifier hs-type">Label</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Compiler.Hoopl.Dataflow.html#OldFact"><span class="hs-identifier hs-type">OldFact</span></a><span> </span><a href="#local-6989586621679059460"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Compiler.Hoopl.Dataflow.html#NewFact"><span class="hs-identifier hs-type">NewFact</span></a><span> </span><a href="#local-6989586621679059460"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="Compiler.Hoopl.Dataflow.html#ChangeFlag"><span class="hs-identifier hs-type">ChangeFlag</span></a><span class="hs-special">,</span><span> </span><a href="Compiler.Hoopl.Pointed.html#Pointed"><span class="hs-identifier hs-type">Pointed</span></a><span> </span><a href="#local-6989586621679059461"><span class="hs-identifier hs-type">t</span></a><span> </span><a href="Compiler.Hoopl.Block.html#C"><span class="hs-identifier hs-type">C</span></a><span> </span><a href="#local-6989586621679059460"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-71"></a><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Compiler.Hoopl.Dataflow.html#DataflowLattice"><span class="hs-identifier hs-type">DataflowLattice</span></a><span> </span><span class="hs-special">(</span><a href="Compiler.Hoopl.Pointed.html#Pointed"><span class="hs-identifier hs-type">Pointed</span></a><span> </span><a href="#local-6989586621679059461"><span class="hs-identifier hs-type">t</span></a><span> </span><a href="Compiler.Hoopl.Block.html#C"><span class="hs-identifier hs-type">C</span></a><span> </span><a href="#local-6989586621679059460"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-72"></a><span>
</span><a name="line-73"></a><a name="addPoints"><a href="Compiler.Hoopl.Pointed.html#addPoints"><span class="hs-identifier">addPoints</span></a></a><span> </span><a name="local-6989586621679059464"><a href="#local-6989586621679059464"><span class="hs-identifier">name</span></a></a><span> </span><a name="local-6989586621679059465"><a href="#local-6989586621679059465"><span class="hs-identifier">join</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Compiler.Hoopl.Pointed.html#addPoints%27"><span class="hs-identifier hs-var">addPoints'</span></a><span> </span><a href="#local-6989586621679059464"><span class="hs-identifier hs-var">name</span></a><span> </span><a href="#local-6989586621679059466"><span class="hs-identifier hs-var">join'</span></a><span>
</span><a name="line-74"></a><span>   </span><span class="hs-keyword">where</span><span> </span><a name="local-6989586621679059466"><a href="#local-6989586621679059466"><span class="hs-identifier">join'</span></a></a><span> </span><a name="local-6989586621679059467"><a href="#local-6989586621679059467"><span class="hs-identifier">l</span></a></a><span> </span><a name="local-6989586621679059468"><a href="#local-6989586621679059468"><span class="hs-identifier">o</span></a></a><span> </span><a name="local-6989586621679059469"><a href="#local-6989586621679059469"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679059470"><span class="hs-identifier hs-var">change</span></a><span class="hs-special">,</span><span> </span><a href="Compiler.Hoopl.Pointed.html#PElem"><span class="hs-identifier hs-var">PElem</span></a><span> </span><a href="#local-6989586621679059471"><span class="hs-identifier hs-var">f</span></a><span class="hs-special">)</span><span>
</span><a name="line-75"></a><span>            </span><span class="hs-keyword">where</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679059470"><a href="#local-6989586621679059470"><span class="hs-identifier">change</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679059471"><a href="#local-6989586621679059471"><span class="hs-identifier">f</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679059465"><span class="hs-identifier hs-var">join</span></a><span> </span><a href="#local-6989586621679059467"><span class="hs-identifier hs-var">l</span></a><span> </span><a href="#local-6989586621679059468"><span class="hs-identifier hs-var">o</span></a><span> </span><a href="#local-6989586621679059469"><span class="hs-identifier hs-var">n</span></a><span>
</span><a name="line-76"></a><span>
</span><a name="line-77"></a><a name="addPoints%27"><a href="Compiler.Hoopl.Pointed.html#addPoints%27"><span class="hs-identifier">addPoints'</span></a></a><span> </span><a name="local-6989586621679059472"><a href="#local-6989586621679059472"><span class="hs-identifier">name</span></a></a><span> </span><a name="local-6989586621679059473"><a href="#local-6989586621679059473"><span class="hs-identifier">joinx</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Compiler.Hoopl.Dataflow.html#DataflowLattice"><span class="hs-identifier hs-var">DataflowLattice</span></a><span> </span><a href="#local-6989586621679059472"><span class="hs-identifier hs-var">name</span></a><span> </span><a href="Compiler.Hoopl.Pointed.html#Bot"><span class="hs-identifier hs-var">Bot</span></a><span> </span><a href="#local-6989586621679059474"><span class="hs-identifier hs-var">join</span></a><span>
</span><a name="line-78"></a><span>  </span><span class="hs-keyword">where</span><span> </span><span class="hs-comment">-- careful: order of cases matters for ChangeFlag</span><span>
</span><a name="line-79"></a><span>        </span><span class="hs-identifier">join</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Compiler.Hoopl.Dataflow.html#JoinFun"><span class="hs-identifier hs-type">JoinFun</span></a><span> </span><span class="hs-special">(</span><a href="Compiler.Hoopl.Pointed.html#Pointed"><span class="hs-identifier hs-type">Pointed</span></a><span> </span><a href="#local-6989586621679059461"><span class="hs-identifier hs-type">t</span></a><span> </span><a href="Compiler.Hoopl.Block.html#C"><span class="hs-identifier hs-type">C</span></a><span> </span><a href="#local-6989586621679059460"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-80"></a><span>        </span><a name="local-6989586621679059474"><a href="#local-6989586621679059474"><span class="hs-identifier">join</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><a href="Compiler.Hoopl.Dataflow.html#OldFact"><span class="hs-identifier hs-var">OldFact</span></a><span> </span><a name="local-6989586621679059475"><a href="#local-6989586621679059475"><span class="hs-identifier">f</span></a></a><span class="hs-special">)</span><span>            </span><span class="hs-special">(</span><a href="Compiler.Hoopl.Dataflow.html#NewFact"><span class="hs-identifier hs-var">NewFact</span></a><span> </span><a href="Compiler.Hoopl.Pointed.html#Bot"><span class="hs-identifier hs-var">Bot</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="Compiler.Hoopl.Dataflow.html#NoChange"><span class="hs-identifier hs-var">NoChange</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679059475"><span class="hs-identifier hs-var">f</span></a><span class="hs-special">)</span><span>
</span><a name="line-81"></a><span>        </span><span class="hs-identifier">join</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><a href="Compiler.Hoopl.Dataflow.html#OldFact"><span class="hs-identifier hs-var">OldFact</span></a><span> </span><a href="Compiler.Hoopl.Pointed.html#Top"><span class="hs-identifier hs-var">Top</span></a><span class="hs-special">)</span><span>          </span><span class="hs-special">(</span><a href="Compiler.Hoopl.Dataflow.html#NewFact"><span class="hs-identifier hs-var">NewFact</span></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="Compiler.Hoopl.Dataflow.html#NoChange"><span class="hs-identifier hs-var">NoChange</span></a><span class="hs-special">,</span><span> </span><a href="Compiler.Hoopl.Pointed.html#Top"><span class="hs-identifier hs-var">Top</span></a><span class="hs-special">)</span><span>
</span><a name="line-82"></a><span>        </span><span class="hs-identifier">join</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><a href="Compiler.Hoopl.Dataflow.html#OldFact"><span class="hs-identifier hs-var">OldFact</span></a><span> </span><a href="Compiler.Hoopl.Pointed.html#Bot"><span class="hs-identifier hs-var">Bot</span></a><span class="hs-special">)</span><span>          </span><span class="hs-special">(</span><a href="Compiler.Hoopl.Dataflow.html#NewFact"><span class="hs-identifier hs-var">NewFact</span></a><span> </span><a name="local-6989586621679059476"><a href="#local-6989586621679059476"><span class="hs-identifier">f</span></a></a><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="Compiler.Hoopl.Dataflow.html#SomeChange"><span class="hs-identifier hs-var">SomeChange</span></a><span class="hs-special">,</span><span> </span><a href="#local-6989586621679059476"><span class="hs-identifier hs-var">f</span></a><span class="hs-special">)</span><span>
</span><a name="line-83"></a><span>        </span><span class="hs-identifier">join</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><a href="Compiler.Hoopl.Dataflow.html#OldFact"><span class="hs-identifier hs-var">OldFact</span></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>            </span><span class="hs-special">(</span><a href="Compiler.Hoopl.Dataflow.html#NewFact"><span class="hs-identifier hs-var">NewFact</span></a><span> </span><a href="Compiler.Hoopl.Pointed.html#Top"><span class="hs-identifier hs-var">Top</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="Compiler.Hoopl.Dataflow.html#SomeChange"><span class="hs-identifier hs-var">SomeChange</span></a><span class="hs-special">,</span><span> </span><a href="Compiler.Hoopl.Pointed.html#Top"><span class="hs-identifier hs-var">Top</span></a><span class="hs-special">)</span><span>
</span><a name="line-84"></a><span>        </span><span class="hs-identifier">join</span><span> </span><a name="local-6989586621679059477"><a href="#local-6989586621679059477"><span class="hs-identifier">l</span></a></a><span> </span><span class="hs-special">(</span><a href="Compiler.Hoopl.Dataflow.html#OldFact"><span class="hs-identifier hs-var">OldFact</span></a><span> </span><span class="hs-special">(</span><a href="Compiler.Hoopl.Pointed.html#PElem"><span class="hs-identifier hs-var">PElem</span></a><span> </span><a name="local-6989586621679059478"><a href="#local-6989586621679059478"><span class="hs-identifier">old</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Compiler.Hoopl.Dataflow.html#NewFact"><span class="hs-identifier hs-var">NewFact</span></a><span> </span><span class="hs-special">(</span><a href="Compiler.Hoopl.Pointed.html#PElem"><span class="hs-identifier hs-var">PElem</span></a><span> </span><a name="local-6989586621679059479"><a href="#local-6989586621679059479"><span class="hs-identifier">new</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-85"></a><span>           </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679059473"><span class="hs-identifier hs-var">joinx</span></a><span> </span><a href="#local-6989586621679059477"><span class="hs-identifier hs-var">l</span></a><span> </span><span class="hs-special">(</span><a href="Compiler.Hoopl.Dataflow.html#OldFact"><span class="hs-identifier hs-var">OldFact</span></a><span> </span><a href="#local-6989586621679059478"><span class="hs-identifier hs-var">old</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Compiler.Hoopl.Dataflow.html#NewFact"><span class="hs-identifier hs-var">NewFact</span></a><span> </span><a href="#local-6989586621679059479"><span class="hs-identifier hs-var">new</span></a><span class="hs-special">)</span><span>
</span><a name="line-86"></a><span>
</span><a name="line-87"></a><span>
</span><a name="line-88"></a><span class="hs-identifier">liftJoinTop</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Compiler.Hoopl.Dataflow.html#JoinFun"><span class="hs-identifier hs-type">JoinFun</span></a><span> </span><a href="#local-6989586621679059459"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Compiler.Hoopl.Dataflow.html#JoinFun"><span class="hs-identifier hs-type">JoinFun</span></a><span> </span><span class="hs-special">(</span><a href="Compiler.Hoopl.Pointed.html#WithTop"><span class="hs-identifier hs-type">WithTop</span></a><span> </span><a href="#local-6989586621679059459"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-89"></a><span class="hs-identifier">extendJoinDomain</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><a name="local-6989586621679059458"><a href="#local-6989586621679059458"><span class="hs-identifier">a</span></a></a><span>
</span><a name="line-90"></a><span>              </span><span class="hs-operator">.</span><span> </span><span class="hs-special">(</span><a href="Compiler.Hoopl.Label.html#Label"><span class="hs-identifier hs-type">Label</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Compiler.Hoopl.Dataflow.html#OldFact"><span class="hs-identifier hs-type">OldFact</span></a><span> </span><a href="#local-6989586621679059458"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Compiler.Hoopl.Dataflow.html#NewFact"><span class="hs-identifier hs-type">NewFact</span></a><span> </span><a href="#local-6989586621679059458"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="Compiler.Hoopl.Dataflow.html#ChangeFlag"><span class="hs-identifier hs-type">ChangeFlag</span></a><span class="hs-special">,</span><span> </span><a href="Compiler.Hoopl.Pointed.html#WithTop"><span class="hs-identifier hs-type">WithTop</span></a><span> </span><a href="#local-6989586621679059458"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-91"></a><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Compiler.Hoopl.Dataflow.html#JoinFun"><span class="hs-identifier hs-type">JoinFun</span></a><span> </span><span class="hs-special">(</span><a href="Compiler.Hoopl.Pointed.html#WithTop"><span class="hs-identifier hs-type">WithTop</span></a><span> </span><a href="#local-6989586621679059458"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-92"></a><span>
</span><a name="line-93"></a><a name="extendJoinDomain"><a href="Compiler.Hoopl.Pointed.html#extendJoinDomain"><span class="hs-identifier">extendJoinDomain</span></a></a><span> </span><a name="local-6989586621679059480"><a href="#local-6989586621679059480"><span class="hs-identifier">joinx</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679059481"><span class="hs-identifier hs-var">join</span></a><span>
</span><a name="line-94"></a><span> </span><span class="hs-keyword">where</span><span> </span><span class="hs-identifier">join</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Compiler.Hoopl.Dataflow.html#JoinFun"><span class="hs-identifier hs-type">JoinFun</span></a><span> </span><span class="hs-special">(</span><a href="Compiler.Hoopl.Pointed.html#WithTop"><span class="hs-identifier hs-type">WithTop</span></a><span> </span><a href="#local-6989586621679059458"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-95"></a><span>       </span><a name="local-6989586621679059481"><a href="#local-6989586621679059481"><span class="hs-identifier">join</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><a href="Compiler.Hoopl.Dataflow.html#OldFact"><span class="hs-identifier hs-var">OldFact</span></a><span> </span><a href="Compiler.Hoopl.Pointed.html#Top"><span class="hs-identifier hs-var">Top</span></a><span class="hs-special">)</span><span>          </span><span class="hs-special">(</span><a href="Compiler.Hoopl.Dataflow.html#NewFact"><span class="hs-identifier hs-var">NewFact</span></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="Compiler.Hoopl.Dataflow.html#NoChange"><span class="hs-identifier hs-var">NoChange</span></a><span class="hs-special">,</span><span> </span><a href="Compiler.Hoopl.Pointed.html#Top"><span class="hs-identifier hs-var">Top</span></a><span class="hs-special">)</span><span>
</span><a name="line-96"></a><span>       </span><span class="hs-identifier">join</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><a href="Compiler.Hoopl.Dataflow.html#OldFact"><span class="hs-identifier hs-var">OldFact</span></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>            </span><span class="hs-special">(</span><a href="Compiler.Hoopl.Dataflow.html#NewFact"><span class="hs-identifier hs-var">NewFact</span></a><span> </span><a href="Compiler.Hoopl.Pointed.html#Top"><span class="hs-identifier hs-var">Top</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="Compiler.Hoopl.Dataflow.html#SomeChange"><span class="hs-identifier hs-var">SomeChange</span></a><span class="hs-special">,</span><span> </span><a href="Compiler.Hoopl.Pointed.html#Top"><span class="hs-identifier hs-var">Top</span></a><span class="hs-special">)</span><span>
</span><a name="line-97"></a><span>       </span><span class="hs-identifier">join</span><span> </span><a name="local-6989586621679059482"><a href="#local-6989586621679059482"><span class="hs-identifier">l</span></a></a><span> </span><span class="hs-special">(</span><a href="Compiler.Hoopl.Dataflow.html#OldFact"><span class="hs-identifier hs-var">OldFact</span></a><span> </span><span class="hs-special">(</span><a href="Compiler.Hoopl.Pointed.html#PElem"><span class="hs-identifier hs-var">PElem</span></a><span> </span><a name="local-6989586621679059483"><a href="#local-6989586621679059483"><span class="hs-identifier">old</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Compiler.Hoopl.Dataflow.html#NewFact"><span class="hs-identifier hs-var">NewFact</span></a><span> </span><span class="hs-special">(</span><a href="Compiler.Hoopl.Pointed.html#PElem"><span class="hs-identifier hs-var">PElem</span></a><span> </span><a name="local-6989586621679059484"><a href="#local-6989586621679059484"><span class="hs-identifier">new</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-98"></a><span>           </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679059480"><span class="hs-identifier hs-var">joinx</span></a><span> </span><a href="#local-6989586621679059482"><span class="hs-identifier hs-var">l</span></a><span> </span><span class="hs-special">(</span><a href="Compiler.Hoopl.Dataflow.html#OldFact"><span class="hs-identifier hs-var">OldFact</span></a><span> </span><a href="#local-6989586621679059483"><span class="hs-identifier hs-var">old</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Compiler.Hoopl.Dataflow.html#NewFact"><span class="hs-identifier hs-var">NewFact</span></a><span> </span><a href="#local-6989586621679059484"><span class="hs-identifier hs-var">new</span></a><span class="hs-special">)</span><span>
</span><a name="line-99"></a><span>
</span><a name="line-100"></a><a name="liftJoinTop"><a href="Compiler.Hoopl.Pointed.html#liftJoinTop"><span class="hs-identifier">liftJoinTop</span></a></a><span> </span><a name="local-6989586621679059485"><a href="#local-6989586621679059485"><span class="hs-identifier">joinx</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Compiler.Hoopl.Pointed.html#extendJoinDomain"><span class="hs-identifier hs-var">extendJoinDomain</span></a><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679059489"><a href="#local-6989586621679059489"><span class="hs-identifier">l</span></a></a><span> </span><a name="local-6989586621679059490"><a href="#local-6989586621679059490"><span class="hs-identifier">old</span></a></a><span> </span><a name="local-6989586621679059491"><a href="#local-6989586621679059491"><span class="hs-identifier">new</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679059486"><span class="hs-identifier hs-var">liftPair</span></a><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a><span> </span><a href="#local-6989586621679059485"><span class="hs-identifier hs-var">joinx</span></a><span> </span><a href="#local-6989586621679059489"><span class="hs-identifier hs-var">l</span></a><span> </span><a href="#local-6989586621679059490"><span class="hs-identifier hs-var">old</span></a><span> </span><a href="#local-6989586621679059491"><span class="hs-identifier hs-var">new</span></a><span class="hs-special">)</span><span>
</span><a name="line-101"></a><span>  </span><span class="hs-keyword">where</span><span> </span><a name="local-6989586621679059486"><a href="#local-6989586621679059486"><span class="hs-identifier">liftPair</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679059487"><a href="#local-6989586621679059487"><span class="hs-identifier">c</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679059488"><a href="#local-6989586621679059488"><span class="hs-identifier">a</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679059487"><span class="hs-identifier hs-var">c</span></a><span class="hs-special">,</span><span> </span><a href="Compiler.Hoopl.Pointed.html#PElem"><span class="hs-identifier hs-var">PElem</span></a><span> </span><a href="#local-6989586621679059488"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-102"></a><span>
</span><a name="line-103"></a><span class="hs-comment">-- | Given a join function and a name, creates a semi lattice by</span><span>
</span><a name="line-104"></a><span class="hs-comment">-- adding a top element but no bottom element.  Caller must supply the bottom </span><span>
</span><a name="line-105"></a><span class="hs-comment">-- element.</span><span>
</span><a name="line-106"></a><span class="hs-identifier">addTop</span><span>  </span><span class="hs-glyph">::</span><span> </span><a href="Compiler.Hoopl.Dataflow.html#DataflowLattice"><span class="hs-identifier hs-type">DataflowLattice</span></a><span> </span><a href="#local-6989586621679059457"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Compiler.Hoopl.Dataflow.html#DataflowLattice"><span class="hs-identifier hs-type">DataflowLattice</span></a><span> </span><span class="hs-special">(</span><a href="Compiler.Hoopl.Pointed.html#WithTop"><span class="hs-identifier hs-type">WithTop</span></a><span> </span><a href="#local-6989586621679059457"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-107"></a><span class="hs-comment">-- | A more general case for creating a new lattice</span><span>
</span><a name="line-108"></a><span class="hs-identifier">addTop'</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><a name="local-6989586621679059456"><a href="#local-6989586621679059456"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-operator">.</span><span>
</span><a name="line-109"></a><span>              </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#String"><span class="hs-identifier hs-type">String</span></a><span>
</span><a name="line-110"></a><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679059456"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-111"></a><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="Compiler.Hoopl.Label.html#Label"><span class="hs-identifier hs-type">Label</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Compiler.Hoopl.Dataflow.html#OldFact"><span class="hs-identifier hs-type">OldFact</span></a><span> </span><a href="#local-6989586621679059456"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Compiler.Hoopl.Dataflow.html#NewFact"><span class="hs-identifier hs-type">NewFact</span></a><span> </span><a href="#local-6989586621679059456"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="Compiler.Hoopl.Dataflow.html#ChangeFlag"><span class="hs-identifier hs-type">ChangeFlag</span></a><span class="hs-special">,</span><span> </span><a href="Compiler.Hoopl.Pointed.html#WithTop"><span class="hs-identifier hs-type">WithTop</span></a><span> </span><a href="#local-6989586621679059456"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-112"></a><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Compiler.Hoopl.Dataflow.html#DataflowLattice"><span class="hs-identifier hs-type">DataflowLattice</span></a><span> </span><span class="hs-special">(</span><a href="Compiler.Hoopl.Pointed.html#WithTop"><span class="hs-identifier hs-type">WithTop</span></a><span> </span><a href="#local-6989586621679059456"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-113"></a><span>
</span><a name="line-114"></a><a name="addTop"><a href="Compiler.Hoopl.Pointed.html#addTop"><span class="hs-identifier">addTop</span></a></a><span> </span><a name="local-6989586621679059492"><a href="#local-6989586621679059492"><span class="hs-identifier">lattice</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Compiler.Hoopl.Pointed.html#addTop%27"><span class="hs-identifier hs-var">addTop'</span></a><span> </span><a href="#local-6989586621679059493"><span class="hs-identifier hs-var">name'</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">fact_bot</span><span> </span><a href="#local-6989586621679059492"><span class="hs-identifier hs-var">lattice</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679059494"><span class="hs-identifier hs-var">join'</span></a><span>
</span><a name="line-115"></a><span>   </span><span class="hs-keyword">where</span><span> </span><a name="local-6989586621679059493"><a href="#local-6989586621679059493"><span class="hs-identifier">name'</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">fact_name</span><span> </span><a href="#local-6989586621679059492"><span class="hs-identifier hs-var">lattice</span></a><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a><span> </span><span class="hs-string">&quot; + T&quot;</span><span>
</span><a name="line-116"></a><span>         </span><a name="local-6989586621679059494"><a href="#local-6989586621679059494"><span class="hs-identifier">join'</span></a></a><span> </span><a name="local-6989586621679059495"><a href="#local-6989586621679059495"><span class="hs-identifier">l</span></a></a><span> </span><a name="local-6989586621679059496"><a href="#local-6989586621679059496"><span class="hs-identifier">o</span></a></a><span> </span><a name="local-6989586621679059497"><a href="#local-6989586621679059497"><span class="hs-identifier">n</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679059498"><span class="hs-identifier hs-var">change</span></a><span class="hs-special">,</span><span> </span><a href="Compiler.Hoopl.Pointed.html#PElem"><span class="hs-identifier hs-var">PElem</span></a><span> </span><a href="#local-6989586621679059499"><span class="hs-identifier hs-var">f</span></a><span class="hs-special">)</span><span>
</span><a name="line-117"></a><span>            </span><span class="hs-keyword">where</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679059498"><a href="#local-6989586621679059498"><span class="hs-identifier">change</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679059499"><a href="#local-6989586621679059499"><span class="hs-identifier">f</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">fact_join</span><span> </span><a href="#local-6989586621679059492"><span class="hs-identifier hs-var">lattice</span></a><span> </span><a href="#local-6989586621679059495"><span class="hs-identifier hs-var">l</span></a><span> </span><a href="#local-6989586621679059496"><span class="hs-identifier hs-var">o</span></a><span> </span><a href="#local-6989586621679059497"><span class="hs-identifier hs-var">n</span></a><span>
</span><a name="line-118"></a><span>
</span><a name="line-119"></a><a name="addTop%27"><a href="Compiler.Hoopl.Pointed.html#addTop%27"><span class="hs-identifier">addTop'</span></a></a><span> </span><a name="local-6989586621679059500"><a href="#local-6989586621679059500"><span class="hs-identifier">name</span></a></a><span> </span><a name="local-6989586621679059501"><a href="#local-6989586621679059501"><span class="hs-identifier">bot</span></a></a><span> </span><a name="local-6989586621679059502"><a href="#local-6989586621679059502"><span class="hs-identifier">joinx</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Compiler.Hoopl.Dataflow.html#DataflowLattice"><span class="hs-identifier hs-var">DataflowLattice</span></a><span> </span><a href="#local-6989586621679059500"><span class="hs-identifier hs-var">name</span></a><span> </span><span class="hs-special">(</span><a href="Compiler.Hoopl.Pointed.html#PElem"><span class="hs-identifier hs-var">PElem</span></a><span> </span><a href="#local-6989586621679059501"><span class="hs-identifier hs-var">bot</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679059503"><span class="hs-identifier hs-var">join</span></a><span>
</span><a name="line-120"></a><span>  </span><span class="hs-keyword">where</span><span> </span><span class="hs-comment">-- careful: order of cases matters for ChangeFlag</span><span>
</span><a name="line-121"></a><span>        </span><span class="hs-identifier">join</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Compiler.Hoopl.Dataflow.html#JoinFun"><span class="hs-identifier hs-type">JoinFun</span></a><span> </span><span class="hs-special">(</span><a href="Compiler.Hoopl.Pointed.html#WithTop"><span class="hs-identifier hs-type">WithTop</span></a><span> </span><a href="#local-6989586621679059456"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-122"></a><span>        </span><a name="local-6989586621679059503"><a href="#local-6989586621679059503"><span class="hs-identifier">join</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><a href="Compiler.Hoopl.Dataflow.html#OldFact"><span class="hs-identifier hs-var">OldFact</span></a><span> </span><a href="Compiler.Hoopl.Pointed.html#Top"><span class="hs-identifier hs-var">Top</span></a><span class="hs-special">)</span><span>          </span><span class="hs-special">(</span><a href="Compiler.Hoopl.Dataflow.html#NewFact"><span class="hs-identifier hs-var">NewFact</span></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="Compiler.Hoopl.Dataflow.html#NoChange"><span class="hs-identifier hs-var">NoChange</span></a><span class="hs-special">,</span><span> </span><a href="Compiler.Hoopl.Pointed.html#Top"><span class="hs-identifier hs-var">Top</span></a><span class="hs-special">)</span><span>
</span><a name="line-123"></a><span>        </span><span class="hs-identifier">join</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><a href="Compiler.Hoopl.Dataflow.html#OldFact"><span class="hs-identifier hs-var">OldFact</span></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span>            </span><span class="hs-special">(</span><a href="Compiler.Hoopl.Dataflow.html#NewFact"><span class="hs-identifier hs-var">NewFact</span></a><span> </span><a href="Compiler.Hoopl.Pointed.html#Top"><span class="hs-identifier hs-var">Top</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="Compiler.Hoopl.Dataflow.html#SomeChange"><span class="hs-identifier hs-var">SomeChange</span></a><span class="hs-special">,</span><span> </span><a href="Compiler.Hoopl.Pointed.html#Top"><span class="hs-identifier hs-var">Top</span></a><span class="hs-special">)</span><span>
</span><a name="line-124"></a><span>        </span><span class="hs-identifier">join</span><span> </span><a name="local-6989586621679059504"><a href="#local-6989586621679059504"><span class="hs-identifier">l</span></a></a><span> </span><span class="hs-special">(</span><a href="Compiler.Hoopl.Dataflow.html#OldFact"><span class="hs-identifier hs-var">OldFact</span></a><span> </span><span class="hs-special">(</span><a href="Compiler.Hoopl.Pointed.html#PElem"><span class="hs-identifier hs-var">PElem</span></a><span> </span><a name="local-6989586621679059505"><a href="#local-6989586621679059505"><span class="hs-identifier">old</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Compiler.Hoopl.Dataflow.html#NewFact"><span class="hs-identifier hs-var">NewFact</span></a><span> </span><span class="hs-special">(</span><a href="Compiler.Hoopl.Pointed.html#PElem"><span class="hs-identifier hs-var">PElem</span></a><span> </span><a name="local-6989586621679059506"><a href="#local-6989586621679059506"><span class="hs-identifier">new</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-125"></a><span>           </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679059502"><span class="hs-identifier hs-var">joinx</span></a><span> </span><a href="#local-6989586621679059504"><span class="hs-identifier hs-var">l</span></a><span> </span><span class="hs-special">(</span><a href="Compiler.Hoopl.Dataflow.html#OldFact"><span class="hs-identifier hs-var">OldFact</span></a><span> </span><a href="#local-6989586621679059505"><span class="hs-identifier hs-var">old</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Compiler.Hoopl.Dataflow.html#NewFact"><span class="hs-identifier hs-var">NewFact</span></a><span> </span><a href="#local-6989586621679059506"><span class="hs-identifier hs-var">new</span></a><span class="hs-special">)</span><span>
</span><a name="line-126"></a><span>
</span><a name="line-127"></a><span class="hs-keyword">instance</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Show.html#Show"><span class="hs-identifier hs-type">Show</span></a><span> </span><a href="#local-6989586621679059452"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Show.html#Show"><span class="hs-identifier hs-type">Show</span></a><span> </span><span class="hs-special">(</span><a href="Compiler.Hoopl.Pointed.html#Pointed"><span class="hs-identifier hs-type">Pointed</span></a><span> </span><a href="#local-6989586621679059453"><span class="hs-identifier hs-type">t</span></a><span> </span><a href="#local-6989586621679059454"><span class="hs-identifier hs-type">b</span></a><span> </span><a href="#local-6989586621679059452"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-128"></a><span>  </span><a name="local-8214565720323790137"><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Show.html#show"><span class="hs-identifier">show</span></a></a><span> </span><a href="Compiler.Hoopl.Pointed.html#Bot"><span class="hs-identifier hs-var">Bot</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;_|_&quot;</span><span>
</span><a name="line-129"></a><span>  </span><span class="hs-identifier">show</span><span> </span><a href="Compiler.Hoopl.Pointed.html#Top"><span class="hs-identifier hs-var">Top</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-string">&quot;T&quot;</span><span>
</span><a name="line-130"></a><span>  </span><span class="hs-identifier">show</span><span> </span><span class="hs-special">(</span><a href="Compiler.Hoopl.Pointed.html#PElem"><span class="hs-identifier hs-var">PElem</span></a><span> </span><a name="local-6989586621679059455"><a href="#local-6989586621679059455"><span class="hs-identifier">a</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Show.html#show"><span class="hs-identifier hs-var">show</span></a><span> </span><a href="#local-6989586621679059455"><span class="hs-identifier hs-var">a</span></a><span>
</span><a name="line-131"></a><span>
</span><a name="line-132"></a><span class="hs-keyword">instance</span><span> </span><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#Functor"><span class="hs-identifier hs-type">Functor</span></a><span> </span><span class="hs-special">(</span><a href="Compiler.Hoopl.Pointed.html#Pointed"><span class="hs-identifier hs-type">Pointed</span></a><span> </span><a href="#local-6989586621679059448"><span class="hs-identifier hs-type">t</span></a><span> </span><a href="#local-6989586621679059449"><span class="hs-identifier hs-type">b</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-133"></a><span>  </span><a name="local-3458764513820541101"><a href="../base-4.10.0.0/src/%{MODULE/./-}.html#%{NAME}/GHC.Base.html#fmap"><span class="hs-identifier">fmap</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><a href="Compiler.Hoopl.Pointed.html#Bot"><span class="hs-identifier hs-var">Bot</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Compiler.Hoopl.Pointed.html#Bot"><span class="hs-identifier hs-var">Bot</span></a><span>
</span><a name="line-134"></a><span>  </span><span class="hs-identifier">fmap</span><span> </span><span class="hs-identifier">_</span><span> </span><a href="Compiler.Hoopl.Pointed.html#Top"><span class="hs-identifier hs-var">Top</span></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Compiler.Hoopl.Pointed.html#Top"><span class="hs-identifier hs-var">Top</span></a><span>
</span><a name="line-135"></a><span>  </span><span class="hs-identifier">fmap</span><span> </span><a name="local-6989586621679059450"><a href="#local-6989586621679059450"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-special">(</span><a href="Compiler.Hoopl.Pointed.html#PElem"><span class="hs-identifier hs-var">PElem</span></a><span> </span><a name="local-6989586621679059451"><a href="#local-6989586621679059451"><span class="hs-identifier">a</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Compiler.Hoopl.Pointed.html#PElem"><span class="hs-identifier hs-var">PElem</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679059450"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679059451"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-136"></a><span>
</span><a name="line-137"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">Eq</span><span> </span><a href="#local-6989586621679059443"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier hs-type">Eq</span><span> </span><span class="hs-special">(</span><a href="Compiler.Hoopl.Pointed.html#Pointed"><span class="hs-identifier hs-type">Pointed</span></a><span> </span><a href="#local-6989586621679059444"><span class="hs-identifier hs-type">t</span></a><span> </span><a href="#local-6989586621679059445"><span class="hs-identifier hs-type">b</span></a><span> </span><a href="#local-6989586621679059443"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-138"></a><span>  </span><a href="Compiler.Hoopl.Pointed.html#Bot"><span class="hs-identifier hs-var">Bot</span></a><span> </span><a name="local-3458764513820541095"><span class="hs-operator">==</span></a><span> </span><a href="Compiler.Hoopl.Pointed.html#Bot"><span class="hs-identifier hs-var">Bot</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-139"></a><span>  </span><a href="Compiler.Hoopl.Pointed.html#Top"><span class="hs-identifier hs-var">Top</span></a><span> </span><span class="hs-operator">==</span><span> </span><a href="Compiler.Hoopl.Pointed.html#Top"><span class="hs-identifier hs-var">Top</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-140"></a><span>  </span><span class="hs-special">(</span><a href="Compiler.Hoopl.Pointed.html#PElem"><span class="hs-identifier hs-var">PElem</span></a><span> </span><a name="local-6989586621679059446"><a href="#local-6989586621679059446"><span class="hs-identifier">a</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-operator">==</span><span> </span><span class="hs-special">(</span><a href="Compiler.Hoopl.Pointed.html#PElem"><span class="hs-identifier hs-var">PElem</span></a><span> </span><a name="local-6989586621679059447"><a href="#local-6989586621679059447"><span class="hs-identifier">a'</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679059446"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="#local-6989586621679059447"><span class="hs-identifier hs-var">a'</span></a><span>
</span><a name="line-141"></a><span>  </span><span class="hs-identifier">_</span><span> </span><span class="hs-operator">==</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">False</span><span>
</span><a name="line-142"></a><span>
</span><a name="line-143"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">Ord</span><span> </span><a href="#local-6989586621679059438"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier hs-type">Ord</span><span> </span><span class="hs-special">(</span><a href="Compiler.Hoopl.Pointed.html#Pointed"><span class="hs-identifier hs-type">Pointed</span></a><span> </span><a href="#local-6989586621679059439"><span class="hs-identifier hs-type">t</span></a><span> </span><a href="#local-6989586621679059440"><span class="hs-identifier hs-type">b</span></a><span> </span><a href="#local-6989586621679059438"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-144"></a><span>  </span><a href="Compiler.Hoopl.Pointed.html#Bot"><span class="hs-identifier hs-var">Bot</span></a><span>     </span><span class="hs-special">`</span><a name="local-8214565720323790273"><span class="hs-identifier">compare</span></a><span class="hs-special">`</span><span> </span><a href="Compiler.Hoopl.Pointed.html#Bot"><span class="hs-identifier hs-var">Bot</span></a><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">EQ</span><span>
</span><a name="line-145"></a><span>  </span><a href="Compiler.Hoopl.Pointed.html#Bot"><span class="hs-identifier hs-var">Bot</span></a><span>     </span><span class="hs-special">`</span><span class="hs-identifier">compare</span><span class="hs-special">`</span><span> </span><span class="hs-identifier">_</span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">LT</span><span>
</span><a name="line-146"></a><span>  </span><span class="hs-identifier">_</span><span>       </span><span class="hs-special">`</span><span class="hs-identifier">compare</span><span class="hs-special">`</span><span> </span><a href="Compiler.Hoopl.Pointed.html#Bot"><span class="hs-identifier hs-var">Bot</span></a><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">GT</span><span>
</span><a name="line-147"></a><span>  </span><a href="Compiler.Hoopl.Pointed.html#PElem"><span class="hs-identifier hs-var">PElem</span></a><span> </span><a name="local-6989586621679059441"><a href="#local-6989586621679059441"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-special">`</span><span class="hs-identifier">compare</span><span class="hs-special">`</span><span> </span><a href="Compiler.Hoopl.Pointed.html#PElem"><span class="hs-identifier hs-var">PElem</span></a><span> </span><a name="local-6989586621679059442"><a href="#local-6989586621679059442"><span class="hs-identifier">a'</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679059441"><span class="hs-identifier hs-var">a</span></a><span> </span><span class="hs-special">`</span><span class="hs-identifier hs-var">compare</span><span class="hs-special">`</span><span> </span><a href="#local-6989586621679059442"><span class="hs-identifier hs-var">a'</span></a><span>
</span><a name="line-148"></a><span>  </span><a href="Compiler.Hoopl.Pointed.html#Top"><span class="hs-identifier hs-var">Top</span></a><span>     </span><span class="hs-special">`</span><span class="hs-identifier">compare</span><span class="hs-special">`</span><span> </span><a href="Compiler.Hoopl.Pointed.html#Top"><span class="hs-identifier hs-var">Top</span></a><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">EQ</span><span>
</span><a name="line-149"></a><span>  </span><a href="Compiler.Hoopl.Pointed.html#Top"><span class="hs-identifier hs-var">Top</span></a><span>     </span><span class="hs-special">`</span><span class="hs-identifier">compare</span><span class="hs-special">`</span><span> </span><span class="hs-identifier">_</span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">GT</span><span>
</span><a name="line-150"></a><span>  </span><span class="hs-identifier">_</span><span>       </span><span class="hs-special">`</span><span class="hs-identifier">compare</span><span class="hs-special">`</span><span> </span><a href="Compiler.Hoopl.Pointed.html#Top"><span class="hs-identifier hs-var">Top</span></a><span>      </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">LT</span><span>
</span><a name="line-151"></a></pre></body></html>